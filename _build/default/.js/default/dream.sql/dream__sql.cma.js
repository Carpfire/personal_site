// Generated by js_of_ocaml
//# buildInfo:effects=false, kind=cma, use-js-string=true, version=5.6.0

//# unitInfo: Provides: Dream__sql
(function
  (globalThis){
   "use strict";
   var runtime = globalThis.jsoo_runtime, Dream_sql = [0];
   runtime.caml_register_global(0, Dream_sql, "Dream__sql");
   return;
  }
  (globalThis));

//# unitInfo: Provides: Dream__sql__Sql
//# unitInfo: Requires: Caqti_driver_info, Caqti_error, Caqti_lwt, Caqti_lwt_unix, Caqti_pool_config, Caqti_request, Caqti_type, Dream__server__Log, Dream_pure__Message, Lwt, Stdlib, Stdlib__Printf, Uri
(function
  (globalThis){
   "use strict";
   var
    runtime = globalThis.jsoo_runtime,
    cst_s = "%s",
    cst_Dream_sql_pool_sqlite_is_n =
      "Dream.sql_pool: 'sqlite' is not a valid scheme; did you mean 'sqlite3'?",
    caml_maybe_attach_backtrace = runtime.caml_maybe_attach_backtrace,
    caml_wrap_exception = runtime.caml_wrap_exception;
   function caml_call1(f, a0){
    return (f.l >= 0 ? f.l : f.l = f.length) == 1
            ? f(a0)
            : runtime.caml_call_gen(f, [a0]);
   }
   function caml_call2(f, a0, a1){
    return (f.l >= 0 ? f.l : f.l = f.length) == 2
            ? f(a0, a1)
            : runtime.caml_call_gen(f, [a0, a1]);
   }
   function caml_call3(f, a0, a1, a2){
    return (f.l >= 0 ? f.l : f.l = f.length) == 3
            ? f(a0, a1, a2)
            : runtime.caml_call_gen(f, [a0, a1, a2]);
   }
   function caml_call5(f, a0, a1, a2, a3, a4){
    return (f.l >= 0 ? f.l : f.l = f.length) == 5
            ? f(a0, a1, a2, a3, a4)
            : runtime.caml_call_gen(f, [a0, a1, a2, a3, a4]);
   }
   function caml_call7(f, a0, a1, a2, a3, a4, a5, a6){
    return (f.l >= 0 ? f.l : f.l = f.length) == 7
            ? f(a0, a1, a2, a3, a4, a5, a6)
            : runtime.caml_call_gen(f, [a0, a1, a2, a3, a4, a5, a6]);
   }
   var
    global_data = runtime.caml_get_global_data(),
    message = "Dream.sql: no pool; did you apply Dream.sql_pool?",
    Caqti_lwt = global_data.Caqti_lwt,
    Lwt = global_data.Lwt,
    Dream_pure_Message = global_data.Dream_pure__Message,
    Stdlib = global_data.Stdlib,
    Caqti_lwt_unix = global_data.Caqti_lwt_unix,
    Uri = global_data.Uri,
    Caqti_pool_config = global_data.Caqti_pool_config,
    Caqti_error = global_data.Caqti_error,
    Stdlib_Printf = global_data.Stdlib__Printf,
    Caqti_driver_info = global_data.Caqti_driver_info,
    Dream_server_Log = global_data.Dream__server__Log,
    Caqti_type = global_data.Caqti_type,
    Caqti_request = global_data.Caqti_request,
    log = caml_call2(Dream_server_Log[19], 0, "dream.sql"),
    pool_field = caml_call3(Dream_pure_Message[39], 0, 0, 0),
    foreign_keys_on =
      caml_call2
       (caml_call2(Caqti_request[7][1], Caqti_type[30], Caqti_type[30]),
        0,
        "PRAGMA foreign_keys = ON"),
    _h_ = [0, [2, 0, 0], cst_s],
    _g_ = [0, 1],
    _f_ = [0, [2, 0, 0], cst_s],
    cst_Dream_set_session_field_co =
      "Dream.set_session_field; could cause deadlock",
    cst_Re_entrant_call_to_Dream_s =
      "Re-entrant call to Dream.sql, perhaps through ",
    _e_ = [0, [2, 0, 0], cst_s],
    _c_ =
      [0,
       [11, cst_Dream_sql_pool_sqlite_is_n, 0],
       cst_Dream_sql_pool_sqlite_is_n],
    _b_ = [0, "sqlite"],
    _d_ =
      [0,
       [11,
        "Dream.sql_pool: cannot create pool for '",
        [2, 0, [11, "': ", [2, 0, 0]]]],
       "Dream.sql_pool: cannot create pool for '%s': %s"],
    _a_ = [0, 0];
   function post_connect(Db){
    var match = caml_call1(Caqti_driver_info[4], Db[1]);
    if(typeof match === "number" && 127507692 === match)
     return caml_call2(Db[13], foreign_keys_on, 0);
    return caml_call1(Lwt[4], _a_);
   }
   function sql_pool(size, uri){
    var pool_cell = [0, 0];
    return function(inner_handler, request){
     var match = pool_cell[1];
     if(match){
      var pool = match[1];
      caml_call3(Dream_pure_Message[41], request, pool_field, pool);
      return caml_call1(inner_handler, request);
     }
     var parsed_uri = caml_call1(Uri[7], uri);
     if(runtime.caml_equal(caml_call1(Uri[29], parsed_uri), _b_)){
      var _r_ = function(log){return caml_call2(log, [0, request], _c_);};
      caml_call1(log[2], _r_);
     }
     var
      pool_config = caml_call5(Caqti_pool_config[1], size, 0, 0, 0, 0),
      pool$0 =
        caml_call7
         (Caqti_lwt_unix[4],
          [0, pool_config],
          [0, post_connect],
          0,
          0,
          0,
          0,
          parsed_uri);
     if(0 === pool$0[0]){
      var pool$1 = pool$0[1];
      pool_cell[1] = [0, pool$1];
      caml_call3(Dream_pure_Message[41], request, pool_field, pool$1);
      return caml_call1(inner_handler, request);
     }
     var
      error = pool$0[1],
      _s_ = caml_call1(Caqti_error[20], error),
      message = caml_call3(Stdlib_Printf[4], _d_, uri, _s_);
     function _t_(log){return caml_call3(log, [0, request], _e_, message);}
     caml_call1(log[1], _t_);
     return caml_call1(Stdlib[2], message);};
   }
   var acquired_sql_connection = caml_call1(Lwt[49], 0);
   function sql(request, callback){
    var match = caml_call2(Dream_pure_Message[40], request, pool_field);
    if(! match){
     var
      _m_ = function(log){return caml_call3(log, [0, request], _h_, message);};
     caml_call1(log[1], _m_);
     return caml_call1(Stdlib[2], message);
    }
    var
     pool = match[1],
     match$0 = caml_call1(Lwt[50], acquired_sql_connection);
    a:
    if(match$0 && match$0[1]){
     var
      message$0 =
        caml_call2
         (Stdlib[28],
          cst_Re_entrant_call_to_Dream_s,
          cst_Dream_set_session_field_co),
      _i_ =
        function(log){return caml_call3(log, [0, request], _f_, message$0);};
     caml_call1(log[2], _i_);
     break a;
    }
    function _j_(db){
     function _n_(param){
      function _o_(exn){throw caml_maybe_attach_backtrace(exn, 1);}
      function _p_(result){return caml_call1(Lwt[4], [0, result]);}
      function _q_(param){return caml_call1(callback, db);}
      return caml_call3(Lwt[9], _q_, _p_, _o_);
     }
     return caml_call1(caml_call2(Lwt[51], acquired_sql_connection, _g_), _n_);
    }
    var
     ppx_lwt_0 = caml_call1(caml_call2(Caqti_lwt_unix[1][2], 0, _j_), pool);
    function _k_(result){return caml_call1(Caqti_lwt[4], result);}
    function _l_(exn){
     try{throw caml_maybe_attach_backtrace(exn, 0);}
     catch(exn){var exn$0 = caml_wrap_exception(exn); return exn$0;}
    }
    return caml_call3(Lwt[81], _l_, ppx_lwt_0, _k_);
   }
   var
    Dream_sql_Sql =
      [0,
       log,
       pool_field,
       foreign_keys_on,
       post_connect,
       sql_pool,
       acquired_sql_connection,
       sql];
   runtime.caml_register_global(26, Dream_sql_Sql, "Dream__sql__Sql");
   return;
  }
  (globalThis));

//# unitInfo: Provides: Dream__sql__Session
//# unitInfo: Requires: Caqti_error, Caqti_lwt, Caqti_request, Caqti_type, Dream__server__Cookie, Dream__server__Session, Dream__sql__Sql, Lwt, Stdlib, Stdlib__List, Stdlib__Option, Unix, Yojson__Basic
(function
  (globalThis){
   "use strict";
   var
    runtime = globalThis.jsoo_runtime,
    cst_Bad_payload$1 = "Bad payload",
    caml_maybe_attach_backtrace = runtime.caml_maybe_attach_backtrace,
    caml_wrap_exception = runtime.caml_wrap_exception;
   function caml_call1(f, a0){
    return (f.l >= 0 ? f.l : f.l = f.length) == 1
            ? f(a0)
            : runtime.caml_call_gen(f, [a0]);
   }
   function caml_call2(f, a0, a1){
    return (f.l >= 0 ? f.l : f.l = f.length) == 2
            ? f(a0, a1)
            : runtime.caml_call_gen(f, [a0, a1]);
   }
   function caml_call3(f, a0, a1, a2){
    return (f.l >= 0 ? f.l : f.l = f.length) == 3
            ? f(a0, a1, a2)
            : runtime.caml_call_gen(f, [a0, a1, a2]);
   }
   function caml_call4(f, a0, a1, a2, a3){
    return (f.l >= 0 ? f.l : f.l = f.length) == 4
            ? f(a0, a1, a2, a3)
            : runtime.caml_call_gen(f, [a0, a1, a2, a3]);
   }
   function caml_call5(f, a0, a1, a2, a3, a4){
    return (f.l >= 0 ? f.l : f.l = f.length) == 5
            ? f(a0, a1, a2, a3, a4)
            : runtime.caml_call_gen(f, [a0, a1, a2, a3, a4]);
   }
   function caml_call7(f, a0, a1, a2, a3, a4, a5, a6){
    return (f.l >= 0 ? f.l : f.l = f.length) == 7
            ? f(a0, a1, a2, a3, a4, a5, a6)
            : runtime.caml_call_gen(f, [a0, a1, a2, a3, a4, a5, a6]);
   }
   function caml_call13
   (f, a0, a1, a2, a3, a4, a5, a6, a7, a8, a9, a10, a11, a12){
    return (f.l >= 0 ? f.l : f.l = f.length) == 13
            ? f(a0, a1, a2, a3, a4, a5, a6, a7, a8, a9, a10, a11, a12)
            : runtime.caml_call_gen
              (f, [a0, a1, a2, a3, a4, a5, a6, a7, a8, a9, a10, a11, a12]);
   }
   var
    global_data = runtime.caml_get_global_data(),
    Lwt = global_data.Lwt,
    Caqti_error = global_data.Caqti_error,
    Dream_server_Session = global_data.Dream__server__Session,
    Unix = global_data.Unix,
    Dream_server_Cookie = global_data.Dream__server__Cookie,
    Dream_sql_Sql = global_data.Dream__sql__Sql,
    Stdlib_List = global_data.Stdlib__List,
    Caqti_lwt = global_data.Caqti_lwt,
    Stdlib = global_data.Stdlib,
    Yojson_Basic = global_data.Yojson__Basic,
    Stdlib_Option = global_data.Stdlib__Option,
    Caqti_type = global_data.Caqti_type,
    Caqti_request = global_data.Caqti_request,
    symbol = Stdlib_Option[5],
    _i_ = [0, 0],
    _h_ = [0, 0],
    cst_Bad_payload$0 = cst_Bad_payload$1,
    cst_Bad_payload = cst_Bad_payload$1,
    cst_INSERT_INTO_dream_session_ =
      "\n      INSERT INTO dream_session (id, label, expires_at, payload)\n      VALUES ($1, $2, $3, $4)\n    ",
    cst_SELECT_label_expires_at_pa =
      "SELECT label, expires_at, payload FROM dream_session WHERE id = $1",
    cst_UPDATE_dream_session_SET_e =
      "UPDATE dream_session SET expires_at = $1 WHERE id = $2",
    cst_UPDATE_dream_session_SET_p =
      "UPDATE dream_session SET payload = $1 WHERE id = $2",
    cst_DELETE_FROM_dream_session_ = "DELETE FROM dream_session WHERE id = $1";
   function serialize_payload(payload){
    function _ae_(param){
     var value = param[2], name = param[1];
     return [0, name, [0, -976970511, value]];
    }
    var assoc = caml_call1(caml_call1(Stdlib_List[20], _ae_), payload);
    return caml_call5(Yojson_Basic[1], 0, 0, 0, 0, [0, 963043957, assoc]);
   }
   var
    _a_ = Caqti_type[30],
    _b_ =
      caml_call4
       (Caqti_type[33],
        Caqti_type[18],
        Caqti_type[18],
        Caqti_type[17],
        Caqti_type[18]),
    query =
      caml_call2
       (caml_call2(Caqti_request[7][1], _b_, _a_),
        0,
        cst_INSERT_INTO_dream_session_);
   function insert(Db, session){
    var
     payload = serialize_payload(session[4]),
     ppx_lwt_0 =
       caml_call2
        (Db[13], query, [0, session[1], session[2], session[3], payload]);
    function _ac_(result){return caml_call1(Caqti_lwt[4], result);}
    function _ad_(exn){
     try{throw caml_maybe_attach_backtrace(exn, 0);}
     catch(exn){var exn$0 = caml_wrap_exception(exn); return exn$0;}
    }
    return caml_call3(Lwt[81], _ad_, ppx_lwt_0, _ac_);
   }
   var
    _c_ =
      caml_call3
       (Caqti_type[32], Caqti_type[18], Caqti_type[17], Caqti_type[18]),
    query$0 =
      caml_call2
       (caml_call2(Caqti_request[7][3], Caqti_type[18], _c_),
        0,
        cst_SELECT_label_expires_at_pa);
   function find_opt(Db, id){
    var ppx_lwt_0 = caml_call2(Db[16], query$0, id);
    function _Y_(result){
     function ___(exn){throw caml_maybe_attach_backtrace(exn, 0);}
     function _$_(param){
      if(! param) return Lwt[37];
      var
       match = param[1],
       payload = match[3],
       expires_at = match[2],
       label = match[1],
       param$0 = caml_call4(Yojson_Basic[33], 0, 0, 0, payload);
      a:
      {
       if(typeof param$0 !== "number" && 963043957 === param$0[1]){
        var
         payload$0 = param$0[2],
         _ab_ =
           function(param){
            var match = param[2];
            if(typeof match !== "number" && -976970511 === match[1]){
             var value = match[2], name = param[1];
             return [0, name, value];
            }
            return caml_call1(Stdlib[2], cst_Bad_payload$0);
           },
         payload$1 = caml_call1(caml_call1(Stdlib_List[20], _ab_), payload$0);
        break a;
       }
       var payload$1 = caml_call1(Stdlib[2], cst_Bad_payload);
      }
      return caml_call1(Lwt[41], [0, id, label, expires_at, payload$1]);
     }
     function _aa_(param){return caml_call1(Caqti_lwt[4], result);}
     return caml_call3(Lwt[9], _aa_, _$_, ___);
    }
    function _Z_(exn){
     try{throw caml_maybe_attach_backtrace(exn, 0);}
     catch(exn){var exn$0 = caml_wrap_exception(exn); return exn$0;}
    }
    return caml_call3(Lwt[81], _Z_, ppx_lwt_0, _Y_);
   }
   var
    _d_ = Caqti_type[30],
    _e_ = caml_call2(Caqti_type[31], Caqti_type[17], Caqti_type[18]),
    query$1 =
      caml_call2
       (caml_call2(Caqti_request[7][1], _e_, _d_),
        0,
        cst_UPDATE_dream_session_SET_e);
   function refresh(Db, session){
    var ppx_lwt_0 = caml_call2(Db[13], query$1, [0, session[3], session[1]]);
    function _W_(result){return caml_call1(Caqti_lwt[4], result);}
    function _X_(exn){
     try{throw caml_maybe_attach_backtrace(exn, 0);}
     catch(exn){var exn$0 = caml_wrap_exception(exn); return exn$0;}
    }
    return caml_call3(Lwt[81], _X_, ppx_lwt_0, _W_);
   }
   var
    _f_ = Caqti_type[30],
    _g_ = caml_call2(Caqti_type[31], Caqti_type[18], Caqti_type[18]),
    query$2 =
      caml_call2
       (caml_call2(Caqti_request[7][1], _g_, _f_),
        0,
        cst_UPDATE_dream_session_SET_p);
   function update(Db, session){
    var
     payload = serialize_payload(session[4]),
     ppx_lwt_0 = caml_call2(Db[13], query$2, [0, payload, session[1]]);
    function _U_(result){return caml_call1(Caqti_lwt[4], result);}
    function _V_(exn){
     try{throw caml_maybe_attach_backtrace(exn, 0);}
     catch(exn){var exn$0 = caml_wrap_exception(exn); return exn$0;}
    }
    return caml_call3(Lwt[81], _V_, ppx_lwt_0, _U_);
   }
   var
    query$3 =
      caml_call2
       (caml_call2(Caqti_request[7][1], Caqti_type[18], Caqti_type[30]),
        0,
        cst_DELETE_FROM_dream_session_);
   function remove(Db, id){
    var ppx_lwt_0 = caml_call2(Db[13], query$3, id);
    function _S_(result){return caml_call1(Caqti_lwt[4], result);}
    function _T_(exn){
     try{throw caml_maybe_attach_backtrace(exn, 0);}
     catch(exn){var exn$0 = caml_wrap_exception(exn); return exn$0;}
    }
    return caml_call3(Lwt[81], _T_, ppx_lwt_0, _S_);
   }
   function create(db, expires_at, attempt){
    var
     _O_ = caml_call1(Dream_server_Session[6], 0),
     session = [0, caml_call1(Dream_server_Session[5], 0), _O_, expires_at, 0];
    function _P_(exn){
     if(exn[1] === Caqti_error[23] && 3 >= attempt)
      return create(db, expires_at, attempt + 1 | 0);
     throw caml_maybe_attach_backtrace(exn, 0);
    }
    function _Q_(param){return caml_call1(Lwt[4], session);}
    function _R_(param){return insert(db, session);}
    return caml_call3(Lwt[9], _R_, _Q_, _P_);
   }
   function put(request, session, name, value){
    var
     _M_ = session[4],
     dictionary = caml_call1(caml_call1(Stdlib_List[55], name), _M_),
     dictionary$0 = [0, [0, name, value], dictionary];
    session[4] = dictionary$0;
    function _N_(db){return update(db, session);}
    return caml_call2(Dream_sql_Sql[7], request, _N_);
   }
   function drop(request, session, name){
    var
     _K_ = session[4],
     dictionary = caml_call1(caml_call1(Stdlib_List[55], name), _K_);
    session[4] = dictionary;
    function _L_(db){return update(db, session);}
    return caml_call2(Dream_sql_Sql[7], request, _L_);
   }
   function invalidate(request, lifetime, operations, session){
    function _F_(db){
     var ppx_lwt_0 = remove(db, session[1][1]);
     function _G_(param){
      var ppx_lwt_0 = create(db, caml_call1(Unix[101], 0) + lifetime, 1);
      function _I_(new_session){
       session[1] = new_session;
       operations[4] = 1;
       return Lwt[36];
      }
      function _J_(exn){
       try{throw caml_maybe_attach_backtrace(exn, 0);}
       catch(exn){var exn$0 = caml_wrap_exception(exn); return exn$0;}
      }
      return caml_call3(Lwt[81], _J_, ppx_lwt_0, _I_);
     }
     function _H_(exn){
      try{throw caml_maybe_attach_backtrace(exn, 0);}
      catch(exn){var exn$0 = caml_wrap_exception(exn); return exn$0;}
     }
     return caml_call3(Lwt[81], _H_, ppx_lwt_0, _G_);
    }
    return caml_call2(Dream_sql_Sql[7], request, _F_);
   }
   function operations(request, lifetime, session, dirty){
    var operations = [];
    function _D_(param){
     return invalidate(request, lifetime, operations, session);
    }
    function _E_(name){return drop(request, session[1], name);}
    runtime.caml_update_dummy
     (operations,
      [0,
       function(name, value){return put(request, session[1], name, value);},
       _E_,
       _D_,
       dirty]);
    return operations;
   }
   function load(lifetime, request){
    function _m_(db){
     var
      now = caml_call1(Unix[101], 0),
      match =
        caml_call7
         (Dream_server_Cookie[3],
          0,
          _h_,
          0,
          0,
          0,
          request,
          Dream_server_Session[3]);
     if(match){
      var id = match[1], match$0 = caml_call1(Dream_server_Session[8], id);
      if(match$0)
       var
        id$0 = match$0[1],
        _n_ = function(exn){throw caml_maybe_attach_backtrace(exn, 0);},
        _o_ =
          function(param){
           if(! param) return Lwt[37];
           var session = param[1];
           if(now < session[3]) return caml_call1(Lwt[4], [0, session]);
           var ppx_lwt_0 = remove(db, id$0);
           function _B_(param){return Lwt[37];}
           function _C_(exn){
            try{throw caml_maybe_attach_backtrace(exn, 0);}
            catch(exn){var exn$0 = caml_wrap_exception(exn); return exn$0;}
           }
           return caml_call3(Lwt[81], _C_, ppx_lwt_0, _B_);
          },
        _p_ = function(param){return find_opt(db, id$0);},
        _q_ = caml_call3(Lwt[9], _p_, _o_, _n_);
      else
       var _q_ = Lwt[37];
      var ppx_lwt_0 = _q_;
     }
     else
      var ppx_lwt_0 = Lwt[37];
     function _r_(valid_session){
      if(valid_session){
       var session = valid_session[1];
       if(lifetime / 2. < session[3] - now)
        var _t_ = caml_call1(Lwt[4], [0, 0, session]);
       else{
        session[3] = now + lifetime;
        var
         ppx_lwt_0$0 = refresh(db, session),
         _w_ = function(param){return caml_call1(Lwt[4], [0, 1, session]);},
         _x_ =
           function(exn){
            try{throw caml_maybe_attach_backtrace(exn, 0);}
            catch(exn){var exn$0 = caml_wrap_exception(exn); return exn$0;}
           },
         _t_ = caml_call3(Lwt[81], _x_, ppx_lwt_0$0, _w_);
       }
       var ppx_lwt_0 = _t_;
      }
      else
       var
        ppx_lwt_0$1 = create(db, now + lifetime, 1),
        _y_ = function(session){return caml_call1(Lwt[4], [0, 1, session]);},
        _z_ =
          function(exn){
           try{throw caml_maybe_attach_backtrace(exn, 0);}
           catch(exn){var exn$0 = caml_wrap_exception(exn); return exn$0;}
          },
        ppx_lwt_0 = caml_call3(Lwt[81], _z_, ppx_lwt_0$1, _y_);
      function _u_(param){
       var
        session = param[2],
        dirty = param[1],
        session$0 = [0, session],
        _A_ = [0, operations(request, lifetime, session$0, dirty), session$0];
       return caml_call1(Lwt[4], _A_);
      }
      function _v_(exn){
       try{throw caml_maybe_attach_backtrace(exn, 0);}
       catch(exn){var exn$0 = caml_wrap_exception(exn); return exn$0;}
      }
      return caml_call3(Lwt[81], _v_, ppx_lwt_0, _u_);
     }
     function _s_(exn){
      try{throw caml_maybe_attach_backtrace(exn, 0);}
      catch(exn){var exn$0 = caml_wrap_exception(exn); return exn$0;}
     }
     return caml_call3(Lwt[81], _s_, ppx_lwt_0, _r_);
    }
    return caml_call2(Dream_sql_Sql[7], request, _m_);
   }
   function send(param, request, response){
    var session = param[2], operations = param[1];
    if(operations[4]){
     var
      id = caml_call1(Dream_server_Session[7], session[1][1]),
      _l_ = caml_call1(Unix[101], 0),
      max_age = session[1][3] - _l_;
     caml_call13
      (Dream_server_Cookie[4],
       0,
       _i_,
       0,
       [0, max_age],
       0,
       0,
       0,
       0,
       0,
       response,
       request,
       Dream_server_Session[3],
       id);
    }
    return caml_call1(Lwt[4], response);
   }
   function back_end(lifetime){
    return [0, function(_k_){return load(lifetime, _k_);}, send];
   }
   function sql_sessions(opt){
    if(opt)
     var sth = opt[1], lifetime = sth;
    else
     var lifetime = Dream_server_Session[15];
    var _j_ = back_end(lifetime);
    return caml_call1(Dream_server_Session[13], _j_);
   }
   var
    Dream_sql_Session =
      [0,
       symbol,
       serialize_payload,
       insert,
       find_opt,
       refresh,
       update,
       remove,
       create,
       put,
       drop,
       invalidate,
       operations,
       load,
       send,
       back_end,
       sql_sessions];
   runtime.caml_register_global(23, Dream_sql_Session, "Dream__sql__Session");
   return;
  }
  (globalThis));

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLjAsImZpbGUiOiJkcmVhbV9fc3FsLmNtYS5qcyIsInNvdXJjZVJvb3QiOiIiLCJuYW1lcyI6WyJtZXNzYWdlIiwibG9nIiwicG9vbF9maWVsZCIsImZvcmVpZ25fa2V5c19vbiIsInBvc3RfY29ubmVjdCIsIkRiIiwic3FsX3Bvb2wiLCJzaXplIiwidXJpIiwicG9vbF9jZWxsIiwiaW5uZXJfaGFuZGxlciIsInJlcXVlc3QiLCJwb29sIiwicGFyc2VkX3VyaSIsInBvb2xfY29uZmlnIiwicG9vbCQwIiwicG9vbCQxIiwiZXJyb3IiLCJhY3F1aXJlZF9zcWxfY29ubmVjdGlvbiIsInNxbCIsImNhbGxiYWNrIiwibWVzc2FnZSQwIiwiZGIiLCJleG4iLCJyZXN1bHQiLCJwcHhfbHd0XzAiLCJleG4kMCIsInN5bWJvbCIsInNlcmlhbGl6ZV9wYXlsb2FkIiwicGF5bG9hZCIsInZhbHVlIiwibmFtZSIsImFzc29jIiwicXVlcnkiLCJpbnNlcnQiLCJzZXNzaW9uIiwicXVlcnkkMCIsImZpbmRfb3B0IiwiaWQiLCJleHBpcmVzX2F0IiwibGFiZWwiLCJwYXlsb2FkJDAiLCJwYXlsb2FkJDEiLCJxdWVyeSQxIiwicmVmcmVzaCIsInF1ZXJ5JDIiLCJ1cGRhdGUiLCJxdWVyeSQzIiwicmVtb3ZlIiwiY3JlYXRlIiwiYXR0ZW1wdCIsInB1dCIsImRpY3Rpb25hcnkiLCJkaWN0aW9uYXJ5JDAiLCJkcm9wIiwiaW52YWxpZGF0ZSIsImxpZmV0aW1lIiwib3BlcmF0aW9ucyIsIm5ld19zZXNzaW9uIiwiZGlydHkiLCJsb2FkIiwibm93IiwiaWQkMCIsInZhbGlkX3Nlc3Npb24iLCJwcHhfbHd0XzAkMCIsInBweF9sd3RfMCQxIiwic2Vzc2lvbiQwIiwic2VuZCIsInJlc3BvbnNlIiwibWF4X2FnZSIsImJhY2tfZW5kIiwic3FsX3Nlc3Npb25zIiwib3B0Iiwic3RoIl0sInNvdXJjZXMiOlsiL2hvbWUvbGlhbS1jYXJwZW50ZXIvLm9wYW0vcGVyc29uYWwtc2l0ZS9saWIvZHJlYW0vc3FsL3NxbC5tbCIsIi9ob21lL2xpYW0tY2FycGVudGVyLy5vcGFtL3BlcnNvbmFsLXNpdGUvbGliL2RyZWFtL3NxbC9zZXNzaW9uLm1sIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7O0U7Ozs7Ozs7Ozs7Ozs7OztHOzs7OztHOzs7OztHOzs7OztHOzs7OztHOzs7OztHQWFFOztJQWtFTUE7Ozs7Ozs7Ozs7Ozs7O0lBbkVKQyxNQUNGO0lBR0VDLGFBQ0Y7SUFLRUM7TUFFRjtRQUFBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztZQUdFQyxhQUFxQkM7SUFDakIsWUFBQSxpQ0FEaUJBOztLQUVWLE9BQUEsV0FGVUEsUUFMckJGO0lBUUssT0FBQTtHQUFrQjtZQUV2QkcsU0FBVUMsTUFBS0M7SUFDQyxJQUFaQztJQUNKLGdCQUFJQyxlQUFjQztLQUVwQixZQUhNRjs7VUFJQ0c7TUFDTCxtQ0FKa0JELFNBbEJsQlQsWUFxQktVO01BQ0wsT0FBQSxXQUpJRixlQUFjQzs7S0FVRCxJQUFiRSxhQUFhLG1CQVpGTDtLQWFaLEdBQUEsbUJBQUEsb0JBRENLO3lCQUVlWixLQUFPLE9BQUEsV0FBUEEsU0FaRFUsZUFjMEM7TUFGMUQsV0FsQ0ZWOztLQXNDb0I7TUFBZGEsY0FBYyxpQ0FsQlZQO01BaUJOUTtRQUVGOztjQURJRDtjQXZCTlY7Ozs7O1VBaUJJUztLQVFKLFNBSElFO1VBSUNDLFNBSkREO01BaEJBTixtQkFvQkNPO01BRUgsbUNBckJnQkwsU0FsQmxCVCxZQXFDS2M7TUFFSCxPQUFBLFdBckJFTixlQUFjQzs7S0E0QlQ7TUFMRE0sUUFSSkY7TUFhSyxNQUFBLDRCQUxERTtNQUdGakIsVUFDRixrQ0E3QldRO2tCQStCRVAsS0FBTyxPQUF0QixXQUFlQSxTQTdCQ1UsZUEwQlpYLFNBRzJDO0tBQS9DLFdBbkRGQztLQW1ERSxPQUFBLHNCQUhJRCxTQUtMO0dBQUE7R0FTSCxJQURFa0IsMEJBQ0Y7WUFFRUMsSUFBSVIsU0FBUVM7SUFDUixZQUFBLG1DQURBVCxTQTVESlQ7OztxQkFnRWVELEtBQU8sT0FBdEIsV0FBZUEsU0FK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LE9BQUEsbUJBWnFDOEI7O1lBY25DRSxTQUFTZDtJQUFXLHlCLE9BdkRwQkksS0F1RFNKLGtCQWRUVztHQWlCSDtZQUVHSSxhQUFlQztJLEdBQUFBO1NBQVdDLE1BQVhELFFBQUFoQixXQUFXaUI7O1NBQVhqQjtJQUNFLFVBTmpCYyxTQUtlZDtJQUNFLE9BQUE7Ozs7O09Bek1qQjdCO09BUUFDO09BTUFNO09BY0FHO09BNEJBTztPQVVBRTtPQVdBRTtPQWlCSUM7T0FlSkU7T0FPQUc7T0FNQUM7T0FTQUU7T0FTQUc7T0F5Q0FPO09BY0FHO09BS0FDOzs7RSIsInNvdXJjZXNDb250ZW50IjpbIigqIFRoaXMgZmlsZSBpcyBwYXJ0IG9mIERyZWFtLCByZWxlYXNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuIFNlZSBMSUNFTlNFLm1kXG4gICBmb3IgZGV0YWlscywgb3IgdmlzaXQgaHR0cHM6Ly9naXRodWIuY29tL2FhbnRyb24vZHJlYW0uXG5cbiAgIENvcHlyaWdodCAyMDIxIEFudG9uIEJhY2hpbiAqKVxuXG5cblxubW9kdWxlIExvZyA9IERyZWFtX19zZXJ2ZXIuTG9nXG5tb2R1bGUgTWVzc2FnZSA9IERyZWFtX3B1cmUuTWVzc2FnZVxuXG5cblxubGV0IGxvZyA9XG4gIExvZy5zdWJfbG9nIFwiZHJlYW0uc3FsXCJcblxuKCogVE9ETyBEZWJ1ZyBtZXRhZGF0YSBmb3IgdGhlIHBvb2xzLiAqKVxubGV0IHBvb2xfZmllbGQgOiAoXywgQ2FxdGlfZXJyb3IudCkgQ2FxdGlfbHd0X3VuaXguUG9vbC50IE1lc3NhZ2UuZmllbGQgPVxuICBNZXNzYWdlLm5ld19maWVsZCAoKVxuXG4oKiBUT0RPIFRoaXMgbWF5IG5vdCBiZSBuZWNlc3Nhcnkgc2luY2UgQ2FxdGkgMS44LjAuIE1heSByZXF1aXJlIHNvbWUgbWVzc2luZ1xuICAgYXJvdW5kLCBcIkVuYWJsZSBmb3JlaWduIGtleSBjb25zdHJhaW50IGNoZWNrcyBmb3IgU1FMaXRlMyBzdGFydGluZyBhdCB0d2Vha3NcbiAgIHZlcnNpb24gMS44LlwiIGluIENIQU5HRVMuICopXG5sZXQgZm9yZWlnbl9rZXlzX29uID1cbiAgbGV0IG9wZW4gQ2FxdGlfcmVxdWVzdC5JbmZpeCBpblxuICAoQ2FxdGlfdHlwZS51bml0IC0+LiBDYXF0aV90eXBlLnVuaXQpIFwiUFJBR01BIGZvcmVpZ25fa2V5cyA9IE9OXCJcbiAgW0BvY2FtbC53YXJuaW5nIFwiLTNcIl1cblxubGV0IHBvc3RfY29ubmVjdCAobW9kdWxlIERiIDogQ2FxdGlfbHd0LkNPTk5FQ1RJT04pID1cbiAgbWF0Y2ggQ2FxdGlfZHJpdmVyX2luZm8uZGlhbGVjdF90YWcgRGIuZHJpdmVyX2luZm8gd2l0aFxuICB8IGBTcWxpdGUgLT4gRGIuZXhlYyBmb3JlaWduX2tleXNfb24gKClcbiAgfCBfIC0+IEx3dC5yZXR1cm4gKE9rICgpKVxuXG5sZXQgc3FsX3Bvb2wgP3NpemUgdXJpID1cbiAgICBsZXQgcG9vbF9jZWxsID0gcmVmIE5vbmUgaW5cbiAgICBmdW4gaW5uZXJfaGFuZGxlciByZXF1ZXN0IC0+XG5cbiAgYmVnaW4gbWF0Y2ggIXBvb2xfY2VsbCB3aXRoXG4gIHwgU29tZSBwb29sIC0+XG4gICAgTWVzc2FnZS5zZXRfZmllbGQgcmVxdWVzdCBwb29sX2ZpZWxkIHBvb2w7XG4gICAgaW5uZXJfaGFuZGxlciByZXF1ZXN0XG4gIHwgTm9uZSAtPlxuICAgICgqIFRoZSBjb3JyZWN0bmVzcyBvZiB0aGlzIGNvZGUgaXMgc3VidGxlLiBUaGVyZSBpcyBubyByYWNlIGNvbmRpdGlvbiB3aXRoXG4gICAgICAgdHdvIHJlcXVlc3RzIGF0dGVtcHRpbmcgdG8gY3JlYXRlIGEgcG9vbCBvbmx5IGJlY2F1c2Ugbm9uZSBvZiB0aGUgY29kZVxuICAgICAgIGJldHdlZW4gY2hlY2tpbmcgcG9vbF9jZWxsIGFuZCBzZXR0aW5nIGl0IGNhbGxzIGludG8gTHd0LiAqKVxuICAgIGxldCBwYXJzZWRfdXJpID0gVXJpLm9mX3N0cmluZyB1cmkgaW5cbiAgICBpZiBVcmkuc2NoZW1lIHBhcnNlZF91cmkgPSBTb21lIFwic3FsaXRlXCIgdGhlblxuICAgICAgbG9nLndhcm5pbmcgKGZ1biBsb2cgLT4gbG9nIH5yZXF1ZXN0XG4gICAgICAgIFwiRHJlYW0uc3FsX3Bvb2w6IFxcXG4gICAgICAgICdzcWxpdGUnIGlzIG5vdCBhIHZhbGlkIHNjaGVtZTsgZGlkIHlvdSBtZWFuICdzcWxpdGUzJz9cIik7XG4gICAgbGV0IHBvb2wgPVxuICAgICAgbGV0IHBvb2xfY29uZmlnID0gQ2FxdGlfcG9vbF9jb25maWcuY3JlYXRlID9tYXhfc2l6ZTpzaXplICgpIGluXG4gICAgICBDYXF0aV9sd3RfdW5peC5jb25uZWN0X3Bvb2wgfnBvb2xfY29uZmlnIH5wb3N0X2Nvbm5lY3QgcGFyc2VkX3VyaSBpblxuICAgIG1hdGNoIHBvb2wgd2l0aFxuICAgIHwgT2sgcG9vbCAtPlxuICAgICAgcG9vbF9jZWxsIDo9IFNvbWUgcG9vbDtcbiAgICAgIE1lc3NhZ2Uuc2V0X2ZpZWxkIHJlcXVlc3QgcG9vbF9maWVsZCBwb29sO1xuICAgICAgaW5uZXJfaGFuZGxlciByZXF1ZXN0XG4gICAgfCBFcnJvciBlcnJvciAtPlxuICAgICAgKCogRGVsaWJlcmF0ZWx5IHJhaXNlIGFuIGV4Y2VwdGlvbiBzbyB0aGF0IGl0IGNhbiBiZSBjb21tdW5pY2F0ZWQgdG8gYW55XG4gICAgICAgICBkZWJ1ZyBoYW5kbGVyLiAqKVxuICAgICAgbGV0IG1lc3NhZ2UgPVxuICAgICAgICBQcmludGYuc3ByaW50ZiBcIkRyZWFtLnNxbF9wb29sOiBjYW5ub3QgY3JlYXRlIHBvb2wgZm9yICclcyc6ICVzXCJcbiAgICAgICAgIHVyaSAoQ2FxdGlfZXJyb3Iuc2hvdyBlcnJvcikgaW5cbiAgICAgIGxvZy5lcnJvciAoZnVuIGxvZyAtPiBsb2cgfnJlcXVlc3QgXCIlc1wiIG1lc3NhZ2UpO1xuICAgICAgZmFpbHdpdGggbWVzc2FnZVxuICBlbmRcblxuKCogSW4gY2FzZSBhIHVzZXIgY2FsbHMgRHJlYW0uc3FsIHdpdGhpbiB0aGUgY2FsbGJhY2sgb2YgYW4gb3V0ZXIgY2FsbCB0b1xuICAgRHJlYW0uc3FsLCBpZiB0aGUgZGF0YWJhc2UgZHJpdmVyIGRvZXMgbm90IHN1cHBvcnQgY29uY3VycmVudCBkYXRhYmFzZVxuICAgY29ubmVjdGlvbnMsIGFzIHdpdGggY2FxdGktZHJpdmVyLXNxbGl0ZTMsIHRoZSBpbm5lciBjYWxsIHRvIERyZWFtLnNxbCBjYW5ub3RcbiAgIG1ha2UgcHJvZ3Jlc3MgYW5kIHJlcXVlc3QgaGFuZGxpbmcgZGVhZGxvY2tzLiBUaGlzIGNhbiBvY2N1ciB3aGVuIHVzaW5nIFNRTFxuICAgc2Vzc2lvbnMsIGEgdHlwaWNhbCBzY2VuYXJpby4gU2VlXG4gICBodHRwczovL2dpdGh1Yi5jb20vYWFudHJvbi9kcmVhbS9pc3N1ZXMvMzMyLiAqKVxubGV0IGFjcXVpcmVkX3NxbF9jb25uZWN0aW9uIDogYm9vbCBMd3Qua2V5ID1cbiAgTHd0Lm5ld19rZXkgKClcblxubGV0IHNxbCByZXF1ZXN0IGNhbGxiYWNrID1cbiAgbWF0Y2ggTWVzc2FnZS5maWVsZCByZXF1ZXN0IHBvb2xfZmllbGQgd2l0aFxuICB8IE5vbmUgLT5cbiAgICBsZXQgbWVzc2FnZSA9IFwiRHJlYW0uc3FsOiBubyBwb29sOyBkaWQgeW91IGFwcGx5IERyZWFtLnNxbF9wb29sP1wiIGluXG4gICAgbG9nLmVycm9yIChmdW4gbG9nIC0+IGxvZyB+cmVxdWVzdCBcIiVzXCIgbWVzc2FnZSk7XG4gICAgZmFpbHdpdGggbWVzc2FnZVxuICB8IFNvbWUgcG9vbCAtPlxuICAgIGJlZ2luIG1hdGNoIEx3dC5nZXQgYWNxdWlyZWRfc3FsX2Nvbm5lY3Rpb24gd2l0aFxuICAgIHwgTm9uZSB8IFNvbWUgZmFsc2UgLT4gKClcbiAgICB8IFNvbWUgdHJ1ZSAtPlxuICAgICAgbGV0IG1lc3NhZ2UgPVxuICAgICAgICBcIlJlLWVudHJhbnQgY2FsbCB0byBEcmVhbS5zcWwsIHBlcmhhcHMgdGhyb3VnaCBcIiBeXG4gICAgICAgIFwiRHJlYW0uc2V0X3Nlc3Npb25fZmllbGQ7IGNvdWxkIGNhdXNlIGRlYWRsb2NrXCJcbiAgICAgIGluXG4gICAgICBsb2cud2FybmluZyAoZnVuIGxvZyAtPiBsb2cgfnJlcXVlc3QgXCIlc1wiIG1lc3NhZ2UpXG4gICAgZW5kO1xuICAgIGxldCVsd3QgcmVzdWx0ID1cbiAgICAgIHBvb2wgfD4gQ2FxdGlfbHd0X3VuaXguUG9vbC51c2UgKGZ1biBkYiAtPlxuICAgICAgICBMd3Qud2l0aF92YWx1ZSBhY3F1aXJlZF9zcWxfY29ubmVjdGlvbiAoU29tZSB0cnVlKSBAQCBmdW4gKCkgLT5cbiAgICAgICAgKCogVGhlIHNwZWNpYWwgZXhjZXB0aW9uIGhhbmRsaW5nIGlzIGEgd29ya2Fyb3VuZCBmb3JcbiAgICAgICAgICAgaHR0cHM6Ly9naXRodWIuY29tL3BhdXJrZWRhbC9vY2FtbC1jYXF0aS9pc3N1ZXMvNjguICopXG4gICAgICAgIG1hdGNoJWx3dCBjYWxsYmFjayBkYiB3aXRoXG4gICAgICAgIHwgcmVzdWx0IC0+IEx3dC5yZXR1cm4gKE9rIHJlc3VsdClcbiAgICAgICAgfCBleGNlcHRpb24gZXhuIC0+IHJhaXNlIGV4bilcbiAgICBpblxuICAgIENhcXRpX2x3dC5vcl9mYWlsIHJlc3VsdFxuIiwiKCogVGhpcyBmaWxlIGlzIHBhcnQgb2YgRHJlYW0sIHJlbGVhc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS4gU2VlIExJQ0VOU0UubWRcbiAgIGZvciBkZXRhaWxzLCBvciB2aXNpdCBodHRwczovL2dpdGh1Yi5jb20vYWFudHJvbi9kcmVhbS5cblxuICAgQ29weXJpZ2h0IDIwMjEgQW50b24gQmFjaGluICopXG5cblxuXG5tb2R1bGUgRHJlYW0gPSBEcmVhbV9wdXJlXG5tb2R1bGUgQ29va2llID0gRHJlYW1fX3NlcnZlci5Db29raWVcbm1vZHVsZSBTZXNzaW9uID0gRHJlYW1fX3NlcnZlci5TZXNzaW9uXG5cblxuXG5sZXQgKHw+PykgPVxuICBPcHRpb24uYmluZFxuXG5tb2R1bGUgdHlwZSBEQiA9IENhcXRpX2x3dC5DT05ORUNUSU9OXG5cbm1vZHVsZSBSID0gQ2FxdGlfcmVxdWVzdFxubW9kdWxlIFQgPSBDYXF0aV90eXBlXG5cbmxldCBzZXJpYWxpemVfcGF5bG9hZCBwYXlsb2FkID1cbiAgcGF5bG9hZFxuICB8PiBMaXN0Lm1hcCAoZnVuIChuYW1lLCB2YWx1ZSkgLT4gbmFtZSwgYFN0cmluZyB2YWx1ZSlcbiAgfD4gZnVuIGFzc29jIC0+IGBBc3NvYyBhc3NvY1xuICB8PiBZb2pzb24uQmFzaWMudG9fc3RyaW5nXG5cbmxldCBpbnNlcnQgPVxuICBsZXQgcXVlcnkgPVxuICAgIGxldCBvcGVuIENhcXRpX3JlcXVlc3QuSW5maXggaW5cbiAgICAoVC4odDQgc3RyaW5nIHN0cmluZyBmbG9hdCBzdHJpbmcpIC0+LiBULnVuaXQpIHt8XG4gICAgICBJTlNFUlQgSU5UTyBkcmVhbV9zZXNzaW9uIChpZCwgbGFiZWwsIGV4cGlyZXNfYXQsIHBheWxvYWQpXG4gICAgICBWQUxVRVMgKCQxLCAkMiwgJDMsICQ0KVxuICAgIHx9IGluXG5cbiAgZnVuIChtb2R1bGUgRGIgOiBEQikgKHNlc3Npb24gOiBTZXNzaW9uLnNlc3Npb24pIC0+XG4gICAgbGV0IHBheWxvYWQgPSBzZXJpYWxpemVfcGF5bG9hZCBzZXNzaW9uLnBheWxvYWQgaW5cbiAgICBsZXQlbHd0IHJlc3VsdCA9XG4gICAgICBEYi5leGVjIHF1ZXJ5IChzZXNzaW9uLmlkLCBzZXNzaW9uLmxhYmVsLCBzZXNzaW9uLmV4cGlyZXNfYXQsIHBheWxvYWQpIGluXG4gICAgQ2FxdGlfbHd0Lm9yX2ZhaWwgcmVzdWx0XG5cbmxldCBmaW5kX29wdCA9XG4gIGxldCBxdWVyeSA9XG4gICAgbGV0IG9wZW4gQ2FxdGlfcmVxdWVzdC5JbmZpeCBpblxuICAgIChULnN0cmluZyAtPj8gVC4odDMgc3RyaW5nIGZsb2F0IHN0cmluZykpXG4gICAgICBcIlNFTEVDVCBsYWJlbCwgZXhwaXJlc19hdCwgcGF5bG9hZCBGUk9NIGRyZWFtX3Nlc3Npb24gV0hFUkUgaWQgPSAkMVwiIGluXG5cbiAgZnVuIChtb2R1bGUgRGIgOiBEQikgaWQgLT5cbiAgICBsZXQlbHd0IHJlc3VsdCA9IERiLmZpbmRfb3B0IHF1ZXJ5IGlkIGluXG4gICAgbWF0Y2glbHd0IENhcXRpX2x3dC5vcl9mYWlsIHJlc3VsdCB3aXRoXG4gICAgfCBOb25lIC0+IEx3dC5yZXR1cm5fbm9uZVxuICAgIHwgU29tZSAobGFiZWwsIGV4cGlyZXNfYXQsIHBheWxvYWQpIC0+XG4gICAgICAoKiBUT0RPIE1pbmQgZXhjZXB0aW9ucyEgKilcbiAgICAgIGxldCBwYXlsb2FkID1cbiAgICAgICAgWW9qc29uLkJhc2ljLmZyb21fc3RyaW5nIHBheWxvYWRcbiAgICAgICAgfD4gZnVuY3Rpb25cbiAgICAgICAgICB8IGBBc3NvYyBwYXlsb2FkIC0+XG4gICAgICAgICAgICBwYXlsb2FkIHw+IExpc3QubWFwIChmdW5jdGlvblxuICAgICAgICAgICAgICB8IG5hbWUsIGBTdHJpbmcgdmFsdWUgLT4gbmFtZSwgdmFsdWVcbiAgICAgICAgICAgICAgfCBfIC0+IGZhaWx3aXRoIFwiQmFkIHBheWxvYWRcIilcbiAgICAgICAgICB8IF8gLT4gZmFpbHdpdGggXCJCYWQgcGF5bG9hZFwiXG4gICAgICBpblxuICAgICAgTHd0LnJldHVybl9zb21lIFNlc3Npb24ue1xuICAgICAgICBpZDtcbiAgICAgICAgbGFiZWw7XG4gICAgICAgIGV4cGlyZXNfYXQ7XG4gICAgICAgIHBheWxvYWQ7XG4gICAgICB9XG5cbmxldCByZWZyZXNoID1cbiAgbGV0IHF1ZXJ5ID1cbiAgICBsZXQgb3BlbiBDYXF0aV9yZXF1ZXN0LkluZml4IGluXG4gICAgKFQuKHQyIGZsb2F0IHN0cmluZykgLT4uIFQudW5pdClcbiAgICAgIFwiVVBEQVRFIGRyZWFtX3Nlc3Npb24gU0VUIGV4cGlyZXNfYXQgPSAkMSBXSEVSRSBpZCA9ICQyXCIgaW5cblxuICBmdW4gKG1vZHVsZSBEYiA6IERCKSAoc2Vzc2lvbiA6IFNlc3Npb24uc2Vzc2lvbikgLT5cbiAgICBsZXQlbHd0IHJlc3VsdCA9IERiLmV4ZWMgcXVlcnkgKHNlc3Npb24uZXhwaXJlc19hdCwgc2Vzc2lvbi5pZCkgaW5cbiAgICBDYXF0aV9sd3Qub3JfZmFpbCByZXN1bHRcblxubGV0IHVwZGF0ZSA9XG4gIGxldCBxdWVyeSA9XG4gICAgbGV0IG9wZW4gQ2FxdGlfcmVxdWVzdC5JbmZpeCBpblxuICAgIChULih0MiBzdHJpbmcgc3RyaW5nKSAtPi4gVC51bml0KVxuICAgICAgXCJVUERBVEUgZHJlYW1fc2Vzc2lvbiBTRVQgcGF5bG9hZCA9ICQxIFdIRVJFIGlkID0gJDJcIiBpblxuXG4gIGZ1biAobW9kdWxlIERiIDogREIpIChzZXNzaW9uIDogU2Vzc2lvbi5zZXNzaW9uKSAtPlxuICAgIGxldCBwYXlsb2FkID0gc2VyaWFsaXplX3BheWxvYWQgc2Vzc2lvbi5wYXlsb2FkIGluXG4gICAgbGV0JWx3dCByZXN1bHQgPSBEYi5leGVjIHF1ZXJ5IChwYXlsb2FkLCBzZXNzaW9uLmlkKSBpblxuICAgIENhcXRpX2x3dC5vcl9mYWlsIHJlc3VsdFxuXG5sZXQgcmVtb3ZlID1cbiAgbGV0IHF1ZXJ5ID1cbiAgICBsZXQgb3BlbiBDYXF0aV9yZXF1ZXN0LkluZml4IGluXG4gICAgKFQuc3RyaW5nIC0+LiBULnVuaXQpIFwiREVMRVRFIEZST00gZHJlYW1fc2Vzc2lvbiBXSEVSRSBpZCA9ICQxXCIgIGluXG5cbiAgZnVuIChtb2R1bGUgRGIgOiBEQikgaWQgLT5cbiAgICBsZXQlbHd0IHJlc3VsdCA9IERiLmV4ZWMgcXVlcnkgaWQgaW5cbiAgICBDYXF0aV9sd3Qub3JfZmFpbCByZXN1bHRcblxuKCogVE9ETyBTZXNzaW9uIHNoYXJpbmcgaXMgZ3JlYXRseSBjb21wbGljYXRlZCBieSB0aGUgYmFja2luZyBzdG9yZTsgaXMgaXQgb2sgdG9cbiAgIGp1c3Qgd29yayB3aXRoIHNuYXBzaG90cz8gQWxsIGtpbmRzIG9mIHJhY2UgY29uZGl0aW9ucyBtYXkgYmUgcG9zc2libGUsXG4gICB1bmxlc3MgdGhlcmUgaXMgYSBnZW5lcmF0aW9uIHZhbHVlIG9yIHRoZSBsaWtlLiAqKVxuKCogVE9ETyBUaGlzIGNhbiBiZSBncmVhdGx5IGFkZHJlc3NlZCB3aXRoIGEgY2FjaGUsIHdoaWNoIGlzIGRlc2lyYWJsZVxuICAgYW55d2F5LiAqKVxuKCogVE9ETyBUaGUgaW4tbWVtb3J5IHNlc3Npb25zIG1hbmFnZXIgc2hvdWxkIGFjdHVhbGx5IGJlIHJlLWRvbmUgaW4gdGVybXMgb2ZcbiAgIHRoZSBjYWNoZSwganVzdCB3aXRoIG5vIHBlcnNpc3RlbnQgYmFja2luZyBzdG9yZS4gKilcblxubGV0IHJlYyBjcmVhdGUgZGIgZXhwaXJlc19hdCBhdHRlbXB0ID1cbiAgbGV0IHNlc3Npb24gPSBTZXNzaW9uLntcbiAgICBpZCA9IFNlc3Npb24ubmV3X2lkICgpO1xuICAgIGxhYmVsID0gU2Vzc2lvbi5uZXdfbGFiZWwgKCk7XG4gICAgZXhwaXJlc19hdDtcbiAgICBwYXlsb2FkID0gW107XG4gIH0gaW5cbiAgKCogQXNzdW1lIHRoYXQgYW55IGV4Y2VwdGlvbiBpcyBhIFBSSU1BUlkgS0VZIGNvbGxpc2lvbiAoZXh0cmVtZWx5IHVubGlrZWx5KVxuICAgICBhbmQgdHJ5IGEgY291cGxlIG1vcmUgdGltZXMuICopXG4gIG1hdGNoJWx3dCBpbnNlcnQgZGIgc2Vzc2lvbiB3aXRoXG4gIHwgZXhjZXB0aW9uIENhcXRpX2Vycm9yLkV4biBfIHdoZW4gYXR0ZW1wdCA8PSAzIC0+XG4gICAgY3JlYXRlIGRiIGV4cGlyZXNfYXQgKGF0dGVtcHQgKyAxKVxuICB8ICgpIC0+XG4gICAgTHd0LnJldHVybiBzZXNzaW9uXG5cbmxldCBwdXQgcmVxdWVzdCAoc2Vzc2lvbiA6IFNlc3Npb24uc2Vzc2lvbikgbmFtZSB2YWx1ZSA9XG4gIHNlc3Npb24ucGF5bG9hZFxuICB8PiBMaXN0LnJlbW92ZV9hc3NvYyBuYW1lXG4gIHw+IGZ1biBkaWN0aW9uYXJ5IC0+IChuYW1lLCB2YWx1ZSk6OmRpY3Rpb25hcnlcbiAgfD4gZnVuIGRpY3Rpb25hcnkgLT4gc2Vzc2lvbi5wYXlsb2FkIDwtIGRpY3Rpb25hcnk7XG4gIFNxbC5zcWwgcmVxdWVzdCAoZnVuIGRiIC0+IHVwZGF0ZSBkYiBzZXNzaW9uKVxuXG5sZXQgZHJvcCByZXF1ZXN0IChzZXNzaW9uIDogU2Vzc2lvbi5zZXNzaW9uKSBuYW1lID1cbiAgc2Vzc2lvbi5wYXlsb2FkXG4gIHw+IExpc3QucmVtb3ZlX2Fzc29jIG5hbWVcbiAgfD4gZnVuIGRpY3Rpb25hcnkgLT4gc2Vzc2lvbi5wYXlsb2FkIDwtIGRpY3Rpb25hcnk7XG4gIFNxbC5zcWwgcmVxdWVzdCAoZnVuIGRiIC0+IHVwZGF0ZSBkYiBzZXNzaW9uKVxuXG5sZXQgaW52YWxpZGF0ZSByZXF1ZXN0IGxpZmV0aW1lIG9wZXJhdGlvbnMgKHNlc3Npb24gOiBTZXNzaW9uLnNlc3Npb24gcmVmKSA9XG4gIFNxbC5zcWwgcmVxdWVzdCBiZWdpbiBmdW4gZGIgLT5cbiAgICBsZXQlbHd0ICgpID0gcmVtb3ZlIGRiICFzZXNzaW9uLmlkIGluXG4gICAgbGV0JWx3dCBuZXdfc2Vzc2lvbiA9IGNyZWF0ZSBkYiAoVW5peC5nZXR0aW1lb2ZkYXkgKCkgKy4gbGlmZXRpbWUpIDEgaW5cbiAgICBzZXNzaW9uIDo9IG5ld19zZXNzaW9uO1xuICAgIG9wZXJhdGlvbnMuU2Vzc2lvbi5kaXJ0eSA8LSB0cnVlO1xuICAgIEx3dC5yZXR1cm5fdW5pdFxuICBlbmRcblxubGV0IG9wZXJhdGlvbnMgcmVxdWVzdCBsaWZldGltZSAoc2Vzc2lvbiA6IFNlc3Npb24uc2Vzc2lvbiByZWYpIGRpcnR5ID1cbiAgbGV0IHJlYyBvcGVyYXRpb25zID0ge1xuICAgIFNlc3Npb24ucHV0ID0gKGZ1biBuYW1lIHZhbHVlIC0+IHB1dCByZXF1ZXN0ICFzZXNzaW9uIG5hbWUgdmFsdWUpO1xuICAgIGRyb3AgPSAoZnVuIG5hbWUgLT4gZHJvcCByZXF1ZXN0ICFzZXNzaW9uIG5hbWUpO1xuICAgIGludmFsaWRhdGUgPSAoZnVuICgpIC0+IGludmFsaWRhdGUgcmVxdWVzdCBsaWZldGltZSBvcGVyYXRpb25zIHNlc3Npb24pO1xuICAgIGRpcnR5O1xuICB9IGluXG4gIG9wZXJhdGlvbnNcblxubGV0IGxvYWQgbGlmZXRpbWUgcmVxdWVzdCA9XG4gIFNxbC5zcWwgcmVxdWVzdCBiZWdpbiBmdW4gZGIgLT5cbiAgICBsZXQgbm93ID0gVW5peC5nZXR0aW1lb2ZkYXkgKCkgaW5cblxuICAgIGxldCVsd3QgdmFsaWRfc2Vzc2lvbiA9XG4gICAgICBtYXRjaCBDb29raWUuY29va2llIHJlcXVlc3QgfmRlY3J5cHQ6ZmFsc2UgU2Vzc2lvbi5zZXNzaW9uX2Nvb2tpZSB3aXRoXG4gICAgICB8IE5vbmUgLT4gTHd0LnJldHVybl9ub25lXG4gICAgICB8IFNvbWUgaWQgLT5cbiAgICAgICAgbWF0Y2ggU2Vzc2lvbi5yZWFkX3Nlc3Npb25faWQgaWQgd2l0aFxuICAgICAgICB8IE5vbmUgLT4gTHd0LnJldHVybl9ub25lXG4gICAgICAgIHwgU29tZSBpZCAtPlxuICAgICAgICAgIG1hdGNoJWx3dCBmaW5kX29wdCBkYiBpZCB3aXRoXG4gICAgICAgICAgfCBOb25lIC0+IEx3dC5yZXR1cm5fbm9uZVxuICAgICAgICAgIHwgU29tZSBzZXNzaW9uIC0+XG4gICAgICAgICAgICBpZiBzZXNzaW9uLmV4cGlyZXNfYXQgPiBub3cgdGhlblxuICAgICAgICAgICAgICBMd3QucmV0dXJuIChTb21lIHNlc3Npb24pXG4gICAgICAgICAgICBlbHNlIGJlZ2luXG4gICAgICAgICAgICAgIGxldCVsd3QgKCkgPSByZW1vdmUgZGIgaWQgaW5cbiAgICAgICAgICAgICAgTHd0LnJldHVybl9ub25lXG4gICAgICAgICAgICBlbmRcbiAgICBpblxuXG4gICAgbGV0JWx3dCBkaXJ0eSwgc2Vzc2lvbiA9XG4gICAgICBtYXRjaCB2YWxpZF9zZXNzaW9uIHdpdGhcbiAgICAgIHwgU29tZSBzZXNzaW9uIC0+XG4gICAgICAgIGlmIHNlc3Npb24uZXhwaXJlc19hdCAtLiBub3cgPiAobGlmZXRpbWUgLy4gMi4pIHRoZW5cbiAgICAgICAgICBMd3QucmV0dXJuIChmYWxzZSwgc2Vzc2lvbilcbiAgICAgICAgZWxzZSBiZWdpblxuICAgICAgICAgIHNlc3Npb24uZXhwaXJlc19hdCA8LSBub3cgKy4gbGlmZXRpbWU7XG4gICAgICAgICAgbGV0JWx3dCAoKSA9IHJlZnJlc2ggZGIgc2Vzc2lvbiBpblxuICAgICAgICAgIEx3dC5yZXR1cm4gKHRydWUsIHNlc3Npb24pXG4gICAgICAgIGVuZFxuICAgICAgfCBOb25lIC0+XG4gICAgICAgIGxldCVsd3Qgc2Vzc2lvbiA9IGNyZWF0ZSBkYiAobm93ICsuIGxpZmV0aW1lKSAxIGluXG4gICAgICAgIEx3dC5yZXR1cm4gKHRydWUsIHNlc3Npb24pXG4gICAgaW5cblxuICAgIGxldCBzZXNzaW9uID0gcmVmIHNlc3Npb24gaW5cbiAgICBMd3QucmV0dXJuIChvcGVyYXRpb25zIHJlcXVlc3QgbGlmZXRpbWUgc2Vzc2lvbiBkaXJ0eSwgc2Vzc2lvbilcbiAgZW5kXG5cbmxldCBzZW5kIChvcGVyYXRpb25zLCBzZXNzaW9uKSByZXF1ZXN0IHJlc3BvbnNlID1cbiAgaWYgb3BlcmF0aW9ucy5TZXNzaW9uLmRpcnR5IHRoZW4gYmVnaW5cbiAgICBsZXQgaWQgPSBTZXNzaW9uLnZlcnNpb25fc2Vzc2lvbl9pZCAhc2Vzc2lvbi5TZXNzaW9uLmlkIGluXG4gICAgbGV0IG1heF9hZ2UgPSAhc2Vzc2lvbi5TZXNzaW9uLmV4cGlyZXNfYXQgLS4gVW5peC5nZXR0aW1lb2ZkYXkgKCkgaW5cbiAgICBDb29raWUuc2V0X2Nvb2tpZVxuICAgICAgcmVzcG9uc2VcbiAgICAgIHJlcXVlc3RcbiAgICAgIFNlc3Npb24uc2Vzc2lvbl9jb29raWVcbiAgICAgIGlkXG4gICAgICB+ZW5jcnlwdDpmYWxzZVxuICAgICAgfm1heF9hZ2VcbiAgZW5kO1xuICBMd3QucmV0dXJuIHJlc3BvbnNlXG5cbmxldCBiYWNrX2VuZCBsaWZldGltZSA9IHtcbiAgU2Vzc2lvbi5sb2FkID0gbG9hZCBsaWZldGltZTtcbiAgc2VuZDtcbn1cblxubGV0IHNxbF9zZXNzaW9ucyA/KGxpZmV0aW1lID0gU2Vzc2lvbi50d29fd2Vla3MpID1cbiAgU2Vzc2lvbi5taWRkbGV3YXJlIChiYWNrX2VuZCBsaWZldGltZSlcbiJdfQ==
