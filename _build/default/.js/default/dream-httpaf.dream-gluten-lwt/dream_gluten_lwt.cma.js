// Generated by js_of_ocaml
//# buildInfo:effects=false, kind=cma, use-js-string=true, version=5.6.0

//# unitInfo: Provides: Dream_gluten_lwt
(function
  (globalThis){
   "use strict";
   var runtime = globalThis.jsoo_runtime, Dream_gluten_lwt = [0];
   runtime.caml_register_global(0, Dream_gluten_lwt, "Dream_gluten_lwt");
   return;
  }
  (globalThis));

//# unitInfo: Provides: Dream_gluten_lwt__Gluten_lwt_intf
(function
  (globalThis){
   "use strict";
   var
    runtime = globalThis.jsoo_runtime,
    Dream_gluten_lwt_Gluten_lwt_in = [0];
   runtime.caml_register_global
    (0, Dream_gluten_lwt_Gluten_lwt_in, "Dream_gluten_lwt__Gluten_lwt_intf");
   return;
  }
  (globalThis));

//# unitInfo: Provides: Dream_gluten_lwt__Gluten_lwt
//# unitInfo: Requires: Dream_gluten__Gluten, Dream_gluten_lwt__Gluten_lwt_intf, Lwt, Stdlib
(function
  (globalThis){
   "use strict";
   var runtime = globalThis.jsoo_runtime;
   function caml_call1(f, a0){
    return (f.l >= 0 ? f.l : f.l = f.length) == 1
            ? f(a0)
            : runtime.caml_call_gen(f, [a0]);
   }
   function caml_call2(f, a0, a1){
    return (f.l >= 0 ? f.l : f.l = f.length) == 2
            ? f(a0, a1)
            : runtime.caml_call_gen(f, [a0, a1]);
   }
   function caml_call3(f, a0, a1, a2){
    return (f.l >= 0 ? f.l : f.l = f.length) == 3
            ? f(a0, a1, a2)
            : runtime.caml_call_gen(f, [a0, a1, a2]);
   }
   function caml_call4(f, a0, a1, a2, a3){
    return (f.l >= 0 ? f.l : f.l = f.length) == 4
            ? f(a0, a1, a2, a3)
            : runtime.caml_call_gen(f, [a0, a1, a2, a3]);
   }
   var
    global_data = runtime.caml_get_global_data(),
    Dream_gluten_Gluten = global_data.Dream_gluten__Gluten,
    Lwt = global_data.Lwt,
    Stdlib = global_data.Stdlib;
   function start(Io, Runtime, t, read_buffer_size, socket){
    var
     read_buffer = caml_call1(Dream_gluten_Gluten[5][1], read_buffer_size),
     match = caml_call1(Lwt[1], 0),
     notify_read_loop_exited = match[2],
     read_loop_exited = match[1];
    function read_loop(param){
     function read_loop_step(param){
      var match = caml_call1(Runtime[1], t);
      if(73271853 === match){
       caml_call2(Runtime[4], t, read_loop);
       return Lwt[36];
      }
      if(914388854 <= match){
       var
        _n_ =
          function(exn){
           if(exn !== Stdlib[12]) return caml_call1(Lwt[5], exn);
           var _u_ = caml_call1(Runtime[3], t);
           caml_call2(Dream_gluten_Gluten[5][2], read_buffer, _u_);
           return read_loop_step(0);
          },
        _o_ =
          function(param){
           function _r_(param){
            var _t_ = caml_call1(Runtime[2], t);
            caml_call2(Dream_gluten_Gluten[5][2], read_buffer, _t_);
            return read_loop_step(0);
           }
           var match = caml_call1(Lwt[1], 0), u = match[2], p = match[1];
           function _p_(n){return caml_call2(Lwt[2], u, n);}
           function _q_(buf, off, len, k){
            var _s_ = caml_call4(Io[1], socket, buf, off, len);
            return caml_call2(Lwt[29], _s_, k);
           }
           caml_call3(Dream_gluten_Gluten[5][3], read_buffer, _q_, _p_);
           return caml_call2(Lwt[33][1], p, _r_);
          };
       return caml_call2(Lwt[7], _o_, _n_);
      }
      caml_call2(Lwt[2], notify_read_loop_exited, 0);
      caml_call1(Io[3], socket);
      return Lwt[36];
     }
     function _l_(param){
      function _m_(exn){caml_call2(Runtime[8], t, exn); return Lwt[36];}
      return caml_call2(Lwt[7], read_loop_step, _m_);
     }
     return caml_call1(Lwt[11], _l_);
    }
    var
     writev = caml_call1(Io[2], socket),
     match$0 = caml_call1(Lwt[1], 0),
     notify_write_loop_exited = match$0[2],
     write_loop_exited = match$0[1];
    function write_loop(param){
     function write_loop_step(param){
      var match = caml_call1(Runtime[5], t);
      if(typeof match === "number"){
       caml_call2(Runtime[7], t, write_loop);
       return Lwt[36];
      }
      if(-477700929 <= match[1]){
       var
        io_vectors = match[2],
        _j_ =
          function(result){
           caml_call2(Runtime[6], t, result);
           return write_loop_step(0);
          },
        _k_ = caml_call1(writev, io_vectors);
       return caml_call2(Lwt[33][1], _k_, _j_);
      }
      caml_call2(Lwt[2], notify_write_loop_exited, 0);
      return Lwt[36];
     }
     function _h_(param){
      function _i_(exn){caml_call2(Runtime[8], t, exn); return Lwt[36];}
      return caml_call2(Lwt[7], write_loop_step, _i_);
     }
     return caml_call1(Lwt[11], _h_);
    }
    read_loop(0);
    write_loop(0);
    function _f_(param){return caml_call1(Io[4], socket);}
    var
     _g_ =
       caml_call1(Lwt[14], [0, read_loop_exited, [0, write_loop_exited, 0]]);
    return caml_call2(Lwt[33][1], _g_, _f_);
   }
   function Client(Io){
    function create(read_buffer_size, protocol, t, socket){
     var connection = caml_call2(Dream_gluten_Gluten[4][11], protocol, t);
     function _d_(param){
      var _e_ = Dream_gluten_Gluten[4];
      return start
              (Io,
               [0,
                _e_[1],
                _e_[2],
                _e_[3],
                _e_[4],
                _e_[5],
                _e_[6],
                _e_[7],
                _e_[8],
                _e_[9],
                _e_[10]],
               connection,
               read_buffer_size,
               socket);
     }
     caml_call1(Lwt[11], _d_);
     return caml_call1(Lwt[4], [0, connection, socket]);
    }
    function upgrade(t, protocol){
     return caml_call2(Dream_gluten_Gluten[4][12], t[1], protocol);
    }
    function shutdown(t){
     caml_call1(Dream_gluten_Gluten[4][10], t[1]);
     return caml_call1(Io[4], t[2]);
    }
    function is_closed(t){return caml_call1(Dream_gluten_Gluten[4][9], t[1]);}
    function socket(t){return t[2];}
    return [0, create, upgrade, shutdown, is_closed, socket];
   }
   var
    Dream_gluten_lwt_Gluten_lwt =
      [0,
       function(Io){
        function create_connection_handler
        (read_buffer_size, protocol, connection, client_addr, socket){
         var
          connection$0 =
            caml_call2(Dream_gluten_Gluten[3][11], protocol, connection),
          _c_ = Dream_gluten_Gluten[3];
         return start
                 (Io,
                  [0,
                   _c_[1],
                   _c_[2],
                   _c_[3],
                   _c_[4],
                   _c_[5],
                   _c_[6],
                   _c_[7],
                   _c_[8],
                   _c_[9],
                   _c_[10]],
                  connection$0,
                  read_buffer_size,
                  socket);
        }
        function create_upgradable_connection_h
        (read_buffer_size,
         protocol,
         create_protocol,
         request_handler,
         client_addr,
         socket){
         var
          _a_ = caml_call1(request_handler, client_addr),
          connection =
            caml_call3
             (Dream_gluten_Gluten[3][13], protocol, create_protocol, _a_),
          _b_ = Dream_gluten_Gluten[3];
         return start
                 (Io,
                  [0,
                   _b_[1],
                   _b_[2],
                   _b_[3],
                   _b_[4],
                   _b_[5],
                   _b_[6],
                   _b_[7],
                   _b_[8],
                   _b_[9],
                   _b_[10]],
                  connection,
                  read_buffer_size,
                  socket);
        }
        return [0, create_upgradable_connection_h, create_connection_handler];
       },
       Client];
   runtime.caml_register_global
    (3, Dream_gluten_lwt_Gluten_lwt, "Dream_gluten_lwt__Gluten_lwt");
   return;
  }
  (globalThis));

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLjAsImZpbGUiOiJkcmVhbV9nbHV0ZW5fbHd0LmNtYS5qcyIsInNvdXJjZVJvb3QiOiIiLCJuYW1lcyI6WyJzdGFydCIsIklvIiwiUnVudGltZSIsInQiLCJyZWFkX2J1ZmZlcl9zaXplIiwic29ja2V0IiwicmVhZF9idWZmZXIiLCJub3RpZnlfcmVhZF9sb29wX2V4aXRlZCIsInJlYWRfbG9vcF9leGl0ZWQiLCJyZWFkX2xvb3AiLCJyZWFkX2xvb3Bfc3RlcCIsImV4biIsInUiLCJwIiwibiIsImJ1ZiIsIm9mZiIsImxlbiIsImsiLCJ3cml0ZXYiLCJub3RpZnlfd3JpdGVfbG9vcF9leGl0ZWQiLCJ3cml0ZV9sb29wX2V4aXRlZCIsIndyaXRlX2xvb3AiLCJ3cml0ZV9sb29wX3N0ZXAiLCJpb192ZWN0b3JzIiwicmVzdWx0IiwiY3JlYXRlIiwicHJvdG9jb2wiLCJjb25uZWN0aW9uIiwidXBncmFkZSIsInNodXRkb3duIiwiaXNfY2xvc2VkIiwiY3JlYXRlX2Nvbm5lY3Rpb25faGFuZGxlciIsImNsaWVudF9hZGRyIiwiY29ubmVjdGlvbiQwIiwiY3JlYXRlX3VwZ3JhZGFibGVfY29ubmVjdGlvbl9oIiwiY3JlYXRlX3Byb3RvY29sIiwicmVxdWVzdF9oYW5kbGVyIl0sInNvdXJjZXMiOlsiL2hvbWUvbGlhbS1jYXJwZW50ZXIvLm9wYW0vcGVyc29uYWwtc2l0ZS9saWIvZHJlYW0taHR0cGFmL2RyZWFtLWdsdXRlbi1sd3QvZ2x1dGVuX2x3dC5tbCJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7OztFOzs7Ozs7Ozs7Ozs7O0U7Ozs7Ozs7OztHOzs7OztHOzs7OztHOzs7OztHOzs7Ozs7Ozs7O1lBbURNQSxNQVNDQyxJQUFZQyxTQUFpQkMsR0FBR0Msa0JBQWlCQztJQUNwRDtLQW5CK0RDLGNBbUI3QyxzQ0FEaUJGO0tBRWEsUUFBQTtLQUExQkc7S0FBbEJDO2FBQ0lDO2NBQ0VDO01BQ0EsWUFBQSxXQUxLUixZQUFpQkM7O09Bb0IxQixXQXBCU0QsWUFBaUJDLEdBR3hCTTtPQWlCRjs7Ozs7bUJBRk9FO1dBTkwsR0FNS0Esb0JBQU8sT0FBQSxtQkFBUEE7V0FINEIsVUFBQSxXQWYxQlQsWUFBaUJDO1dBZWpCLHNDQWpDZ0RHO1dBaUNoRCxPQVhMSTtVQWN1Qjs7OztZQVJvQixVQUFBLFdBVnRDUixZQUFpQkM7WUFVTCxzQ0E1Qm9DRztZQTRCcEMsT0FOakJJO1dBT2tCO1dBNUJqQixJQUFBLFFBQUEsdUJBQUpFLGNBQUhDO1dBQ0osYUFJT0MsR0FBSyxPQUFBLG1CQUxMRixHQUtBRSxHQUF5Qjt3QkFIdEJDLEtBQUtDLEtBQUtDLEtBQUlDO1lBQ0wsVUFBQSxXQWNoQmpCLE9BQWlESSxRQWYxQ1UsS0FBS0MsS0FBS0M7WUFDaEIsT0FBQSx5QkFEb0JDO1dBQzJCO1dBRm5ELHNDQUYrRFo7V0EyQlosT0FBQSx1QkExQi9DTztVQTRCd0I7T0FDcEIsT0FBQTs7TUFXRixtQkFyQmdCTjtNQXNCaEIsV0F4QkhOLE9BQWlESTtNQXdCOUM7S0FDZTs7bUJBR2FNLEtBQzVCLFdBN0JTVCxZQUFpQkMsR0E0QkVRLE1BQzVCLGVBQ2U7TUFGUSxPQUFBLG1CQXhCbkJEO0tBMEJZO0tBSFYsT0FBQTtJQUdXO0lBRVY7S0FBVFMsU0FBUyxXQWhDVmxCLE9BQWlESTtLQWlDRixVQUFBO0tBQTNCZTtLQUFuQkM7YUFDSUM7Y0FDRUM7TUFDQSxZQUFBLFdBcENLckIsWUFBaUJDOztPQTBDMUIsV0ExQ1NELFlBQWlCQyxHQWtDeEJtQjtPQVFGOzs7T0FKQTtRQURPRTs7bUJBQ21CQztXQUMxQixXQXZDU3ZCLFlBQWlCQyxHQXNDQXNCO1dBQzFCLE9BSklGO1VBS2M7UUFGbEIsTUFBQSxXQU5GSixRQUtTSztPQUNlLE9BQUE7O01BT3RCLG1CQVppQko7TUFZakI7S0FDZTs7bUJBR2NULEtBQzdCLFdBbERTVCxZQUFpQkMsR0FpREdRLE1BQzdCLGVBQ2U7TUFGUyxPQUFBLG1CQWRwQlk7S0FnQlk7S0FIVixPQUFBO0lBR1c7SUFoRGZkO0lBK0JBYTt3QkFzQlIsT0FGQSxXQXRER3JCLE9BQWlESSxRQXdEckM7SUFEZjs7T0FBQSx3QkFyRElHLHNCQStCQWE7SUFzQmlELE9BQUE7R0FDdEM7O2FBNERiSyxPQUFRdEIsa0JBQWtCdUIsVUFBU3hCLEdBQUVFO0tBQ3RCLElBQWJ1QixhQUFhLHVDQURXRCxVQUFTeEI7O01BR25DO01BREYsT0EvSEVIOzs7Ozs7Ozs7Ozs7O2VBOEhFNEI7ZUFETXhCO2VBQTZCQztLQVE3QjtLQU5WO0tBT1csT0FBQSx1QkFSUHVCLFlBRG1DdkI7SUFTTjthQUUvQndCLFFBQVExQixHQUFFd0I7S0FDWixPQUFBLHVDQURVeEIsTUFBRXdCO0lBQzRDO2FBRXRERyxTQUFTM0I7S0FDWCx1Q0FEV0E7OEJBQUFBO0lBRU07YUFFZjRCLFVBQVU1QixHQUFJLDZDQUFKQSxNQUE0QzthQUN0REUsT0FBT0YsR0FBSSxPQUFKQSxLQUFZO0lBL0JDLFdBWXBCdUIsUUFXQUcsU0FHQUMsVUFJQUMsV0FDQTFCOzs7Ozs7aUJBcEVBMkI7U0FDQzVCLGtCQUNBdUIsVUFDREMsWUFDQUssYUFDQTVCO1NBRUY7VUFBSTZCO1lBQWEsdUNBTGRQLFVBQ0RDOztTQUtGLE9BcEZFNUI7Ozs7Ozs7Ozs7Ozs7a0JBbUZFa0M7a0JBTkQ5QjtrQkFJREM7UUFRTTtpQkFFTjhCO1NBQ0MvQjtTQUNBdUI7U0FDQVM7U0FDQUM7U0FDREo7U0FDQTVCO1NBRUY7VUFJSSxNQUFBLFdBUkRnQyxpQkFDREo7VUFHRUw7WUFDRjswQ0FQQ0QsVUFDQVM7O1NBV0gsT0F6R0VwQzs7Ozs7Ozs7Ozs7OztrQkFtR0U0QjtrQkFQRHhCO2tCQUtEQztRQWFNO21CQW5CTjhCLGdDQWZBSDs7Ozs7O0UiLCJzb3VyY2VzQ29udGVudCI6WyIoKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAqICBDb3B5cmlnaHQgKGMpIDIwMTggSW5oYWJpdGVkIFR5cGUgTExDLlxuICogIENvcHlyaWdodCAoYykgMjAxOCBBbnRvbiBCYWNoaW5cbiAqICBDb3B5cmlnaHQgKGMpIDIwMTktMjAyMCBBbnRvbmlvIE4uIE1vbnRlaXJvLlxuICpcbiAqICBBbGwgcmlnaHRzIHJlc2VydmVkLlxuICpcbiAqICBSZWRpc3RyaWJ1dGlvbiBhbmQgdXNlIGluIHNvdXJjZSBhbmQgYmluYXJ5IGZvcm1zLCB3aXRoIG9yIHdpdGhvdXRcbiAqICBtb2RpZmljYXRpb24sIGFyZSBwZXJtaXR0ZWQgcHJvdmlkZWQgdGhhdCB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnNcbiAqICBhcmUgbWV0OlxuICpcbiAqICAxLiBSZWRpc3RyaWJ1dGlvbnMgb2Ygc291cmNlIGNvZGUgbXVzdCByZXRhaW4gdGhlIGFib3ZlIGNvcHlyaWdodFxuICogICAgIG5vdGljZSwgdGhpcyBsaXN0IG9mIGNvbmRpdGlvbnMgYW5kIHRoZSBmb2xsb3dpbmcgZGlzY2xhaW1lci5cbiAqXG4gKiAgMi4gUmVkaXN0cmlidXRpb25zIGluIGJpbmFyeSBmb3JtIG11c3QgcmVwcm9kdWNlIHRoZSBhYm92ZSBjb3B5cmlnaHRcbiAqICAgICBub3RpY2UsIHRoaXMgbGlzdCBvZiBjb25kaXRpb25zIGFuZCB0aGUgZm9sbG93aW5nIGRpc2NsYWltZXIgaW4gdGhlXG4gKiAgICAgZG9jdW1lbnRhdGlvbiBhbmQvb3Igb3RoZXIgbWF0ZXJpYWxzIHByb3ZpZGVkIHdpdGggdGhlIGRpc3RyaWJ1dGlvbi5cbiAqXG4gKiAgMy4gTmVpdGhlciB0aGUgbmFtZSBvZiB0aGUgYXV0aG9yIG5vciB0aGUgbmFtZXMgb2YgaGlzIGNvbnRyaWJ1dG9yc1xuICogICAgIG1heSBiZSB1c2VkIHRvIGVuZG9yc2Ugb3IgcHJvbW90ZSBwcm9kdWN0cyBkZXJpdmVkIGZyb20gdGhpcyBzb2Z0d2FyZVxuICogICAgIHdpdGhvdXQgc3BlY2lmaWMgcHJpb3Igd3JpdHRlbiBwZXJtaXNzaW9uLlxuICpcbiAqICBUSElTIFNPRlRXQVJFIElTIFBST1ZJREVEIEJZIFRIRSBDT05UUklCVVRPUlMgYGBBUyBJUycnIEFORCBBTlkgRVhQUkVTU1xuICogIE9SIElNUExJRUQgV0FSUkFOVElFUywgSU5DTFVESU5HLCBCVVQgTk9UIExJTUlURUQgVE8sIFRIRSBJTVBMSUVEXG4gKiAgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFkgQU5EIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFSRVxuICogIERJU0NMQUlNRUQuICBJTiBOTyBFVkVOVCBTSEFMTCBUSEUgQVVUSE9SUyBPUiBDT05UUklCVVRPUlMgQkUgTElBQkxFIEZPUlxuICogIEFOWSBESVJFQ1QsIElORElSRUNULCBJTkNJREVOVEFMLCBTUEVDSUFMLCBFWEVNUExBUlksIE9SIENPTlNFUVVFTlRJQUxcbiAqICBEQU1BR0VTIChJTkNMVURJTkcsIEJVVCBOT1QgTElNSVRFRCBUTywgUFJPQ1VSRU1FTlQgT0YgU1VCU1RJVFVURSBHT09EU1xuICogIE9SIFNFUlZJQ0VTOyBMT1NTIE9GIFVTRSwgREFUQSwgT1IgUFJPRklUUzsgT1IgQlVTSU5FU1MgSU5URVJSVVBUSU9OKVxuICogIEhPV0VWRVIgQ0FVU0VEIEFORCBPTiBBTlkgVEhFT1JZIE9GIExJQUJJTElUWSwgV0hFVEhFUiBJTiBDT05UUkFDVCxcbiAqICBTVFJJQ1QgTElBQklMSVRZLCBPUiBUT1JUIChJTkNMVURJTkcgTkVHTElHRU5DRSBPUiBPVEhFUldJU0UpIEFSSVNJTkcgSU5cbiAqICBBTlkgV0FZIE9VVCBPRiBUSEUgVVNFIE9GIFRISVMgU09GVFdBUkUsIEVWRU4gSUYgQURWSVNFRCBPRiBUSEVcbiAqICBQT1NTSUJJTElUWSBPRiBTVUNIIERBTUFHRS5cbiAqLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKilcblxubW9kdWxlIEdsdXRlbiA9IERyZWFtX2dsdXRlbi5HbHV0ZW5cblxub3BlbiBMd3QuSW5maXhcbm1vZHVsZSBCdWZmZXIgPSBHbHV0ZW4uQnVmZmVyXG5pbmNsdWRlIEdsdXRlbl9sd3RfaW50ZlxuXG5tb2R1bGUgSU9fbG9vcCA9IHN0cnVjdFxuICBsZXQgcmVhZCAodHlwZSBmZCkgKG1vZHVsZSBJbyA6IElPIHdpdGggdHlwZSBzb2NrZXQgPSBmZCkgc29ja2V0IHJlYWRfYnVmZmVyID1cbiAgICBsZXQgcCwgdSA9IEx3dC53YWl0ICgpIGluXG4gICAgQnVmZmVyLnB1dFxuICAgICAgfmY6KGZ1biBidWYgfm9mZiB+bGVuIGsgLT5cbiAgICAgICAgTHd0Lm9uX3N1Y2Nlc3MgKElvLnJlYWQgc29ja2V0IGJ1ZiB+b2ZmIH5sZW4pIGspXG4gICAgICByZWFkX2J1ZmZlclxuICAgICAgKGZ1biBuIC0+IEx3dC53YWtldXBfbGF0ZXIgdSBuKTtcbiAgICBwXG5cbiAgbGV0IHN0YXJ0IDpcbiAgICAgIHR5cGUgdCBmZC5cbiAgICAgIChtb2R1bGUgSU8gd2l0aCB0eXBlIHNvY2tldCA9IGZkKVxuICAgICAgLT4gKG1vZHVsZSBHbHV0ZW4uUlVOVElNRSB3aXRoIHR5cGUgdCA9IHQpXG4gICAgICAtPiB0XG4gICAgICAtPiByZWFkX2J1ZmZlcl9zaXplOmludFxuICAgICAgLT4gZmRcbiAgICAgIC0+IHVuaXQgTHd0LnRcbiAgICA9XG4gICBmdW4gKG1vZHVsZSBJbykgKG1vZHVsZSBSdW50aW1lKSB0IH5yZWFkX2J1ZmZlcl9zaXplIHNvY2tldCAtPlxuICAgIGxldCByZWFkX2J1ZmZlciA9IEJ1ZmZlci5jcmVhdGUgcmVhZF9idWZmZXJfc2l6ZSBpblxuICAgIGxldCByZWFkX2xvb3BfZXhpdGVkLCBub3RpZnlfcmVhZF9sb29wX2V4aXRlZCA9IEx3dC53YWl0ICgpIGluXG4gICAgbGV0IHJlYyByZWFkX2xvb3AgKCkgPVxuICAgICAgbGV0IHJlYyByZWFkX2xvb3Bfc3RlcCAoKSA9XG4gICAgICAgIG1hdGNoIFJ1bnRpbWUubmV4dF9yZWFkX29wZXJhdGlvbiB0IHdpdGhcbiAgICAgICAgfCBgUmVhZCAtPlxuICAgICAgICAgIEx3dC5jYXRjaFxuICAgICAgICAgICAgKGZ1biAoKSAtPlxuICAgICAgICAgICAgICAgcmVhZCAobW9kdWxlIElvKSBzb2NrZXQgcmVhZF9idWZmZXIgPj49IGZ1biAoXyA6IGludCkgLT5cbiAgICAgICAgICAgICAgIGxldCAoXyA6IGludCkgPSBCdWZmZXIuZ2V0IHJlYWRfYnVmZmVyIH5mOihSdW50aW1lLnJlYWQgdCkgaW5cbiAgICAgICAgICAgICAgIHJlYWRfbG9vcF9zdGVwICgpKVxuICAgICAgICAgICAgKGZ1bmN0aW9uXG4gICAgICAgICAgICAgICB8IEVuZF9vZl9maWxlIC0+XG4gICAgICAgICAgICAgICAgIGxldCAoXyA6IGludCkgPVxuICAgICAgICAgICAgICAgICAgIEJ1ZmZlci5nZXQgcmVhZF9idWZmZXIgfmY6KFJ1bnRpbWUucmVhZF9lb2YgdClcbiAgICAgICAgICAgICAgICAgaW5cbiAgICAgICAgICAgICAgICAgcmVhZF9sb29wX3N0ZXAgKClcbiAgICAgICAgICAgICAgIHwgZXhuIC0+IEx3dC5mYWlsIGV4bilcbiAgICAgICAgfCBgWWllbGQgLT5cbiAgICAgICAgICBSdW50aW1lLnlpZWxkX3JlYWRlciB0IHJlYWRfbG9vcDtcbiAgICAgICAgICBMd3QucmV0dXJuX3VuaXRcbiAgICAgICAgfCBgQ2xvc2UgLT5cbiAgICAgICAgICBMd3Qud2FrZXVwX2xhdGVyIG5vdGlmeV9yZWFkX2xvb3BfZXhpdGVkICgpO1xuICAgICAgICAgIElvLnNodXRkb3duX3JlY2VpdmUgc29ja2V0O1xuICAgICAgICAgIEx3dC5yZXR1cm5fdW5pdFxuICAgICAgaW5cbiAgICAgIEx3dC5hc3luYyAoZnVuICgpIC0+XG4gICAgICAgIEx3dC5jYXRjaCByZWFkX2xvb3Bfc3RlcCAoZnVuIGV4biAtPlxuICAgICAgICAgIFJ1bnRpbWUucmVwb3J0X2V4biB0IGV4bjtcbiAgICAgICAgICBMd3QucmV0dXJuX3VuaXQpKVxuICAgIGluXG4gICAgbGV0IHdyaXRldiA9IElvLndyaXRldiBzb2NrZXQgaW5cbiAgICBsZXQgd3JpdGVfbG9vcF9leGl0ZWQsIG5vdGlmeV93cml0ZV9sb29wX2V4aXRlZCA9IEx3dC53YWl0ICgpIGluXG4gICAgbGV0IHJlYyB3cml0ZV9sb29wICgpID1cbiAgICAgIGxldCByZWMgd3JpdGVfbG9vcF9zdGVwICgpID1cbiAgICAgICAgbWF0Y2ggUnVudGltZS5uZXh0X3dyaXRlX29wZXJhdGlvbiB0IHdpdGhcbiAgICAgICAgfCBgV3JpdGUgaW9fdmVjdG9ycyAtPlxuICAgICAgICAgIHdyaXRldiBpb192ZWN0b3JzID4+PSBmdW4gcmVzdWx0IC0+XG4gICAgICAgICAgUnVudGltZS5yZXBvcnRfd3JpdGVfcmVzdWx0IHQgcmVzdWx0O1xuICAgICAgICAgIHdyaXRlX2xvb3Bfc3RlcCAoKVxuICAgICAgICB8IGBZaWVsZCAtPlxuICAgICAgICAgIFJ1bnRpbWUueWllbGRfd3JpdGVyIHQgd3JpdGVfbG9vcDtcbiAgICAgICAgICBMd3QucmV0dXJuX3VuaXRcbiAgICAgICAgfCBgQ2xvc2UgXyAtPlxuICAgICAgICAgIEx3dC53YWtldXBfbGF0ZXIgbm90aWZ5X3dyaXRlX2xvb3BfZXhpdGVkICgpO1xuICAgICAgICAgIEx3dC5yZXR1cm5fdW5pdFxuICAgICAgaW5cbiAgICAgIEx3dC5hc3luYyAoZnVuICgpIC0+XG4gICAgICAgIEx3dC5jYXRjaCB3cml0ZV9sb29wX3N0ZXAgKGZ1biBleG4gLT5cbiAgICAgICAgICBSdW50aW1lLnJlcG9ydF9leG4gdCBleG47XG4gICAgICAgICAgTHd0LnJldHVybl91bml0KSlcbiAgICBpblxuICAgIHJlYWRfbG9vcCAoKTtcbiAgICB3cml0ZV9sb29wICgpO1xuICAgIEx3dC5qb2luIFsgcmVhZF9sb29wX2V4aXRlZDsgd3JpdGVfbG9vcF9leGl0ZWQgXSA+Pj0gZnVuICgpIC0+XG4gICAgSW8uY2xvc2Ugc29ja2V0XG5lbmRcblxubW9kdWxlIFNlcnZlciAoSW8gOiBJTykgPSBzdHJ1Y3RcbiAgbW9kdWxlIEdsdXRlbiA9IERyZWFtX2dsdXRlbi5HbHV0ZW5cblxuICBtb2R1bGUgU2VydmVyID0gR2x1dGVuLlNlcnZlclxuXG4gIHR5cGUgc29ja2V0ID0gSW8uc29ja2V0XG4gIHR5cGUgYWRkciA9IElvLmFkZHJcblxuICBsZXQgY3JlYXRlX2Nvbm5lY3Rpb25faGFuZGxlclxuICAgICAgfnJlYWRfYnVmZmVyX3NpemVcbiAgICAgIH5wcm90b2NvbFxuICAgICAgY29ubmVjdGlvblxuICAgICAgX2NsaWVudF9hZGRyXG4gICAgICBzb2NrZXRcbiAgICA9XG4gICAgbGV0IGNvbm5lY3Rpb24gPSBTZXJ2ZXIuY3JlYXRlIH5wcm90b2NvbCBjb25uZWN0aW9uIGluXG4gICAgSU9fbG9vcC5zdGFydFxuICAgICAgKG1vZHVsZSBJbylcbiAgICAgIChtb2R1bGUgU2VydmVyKVxuICAgICAgY29ubmVjdGlvblxuICAgICAgfnJlYWRfYnVmZmVyX3NpemVcbiAgICAgIHNvY2tldFxuXG4gIGxldCBjcmVhdGVfdXBncmFkYWJsZV9jb25uZWN0aW9uX2hhbmRsZXJcbiAgICAgIH5yZWFkX2J1ZmZlcl9zaXplXG4gICAgICB+cHJvdG9jb2xcbiAgICAgIH5jcmVhdGVfcHJvdG9jb2xcbiAgICAgIH5yZXF1ZXN0X2hhbmRsZXJcbiAgICAgIGNsaWVudF9hZGRyXG4gICAgICBzb2NrZXRcbiAgICA9XG4gICAgbGV0IGNvbm5lY3Rpb24gPVxuICAgICAgU2VydmVyLmNyZWF0ZV91cGdyYWRhYmxlXG4gICAgICAgIH5wcm90b2NvbFxuICAgICAgICB+Y3JlYXRlOmNyZWF0ZV9wcm90b2NvbFxuICAgICAgICAocmVxdWVzdF9oYW5kbGVyIGNsaWVudF9hZGRyKVxuICAgIGluXG4gICAgSU9fbG9vcC5zdGFydFxuICAgICAgKG1vZHVsZSBJbylcbiAgICAgIChtb2R1bGUgU2VydmVyKVxuICAgICAgY29ubmVjdGlvblxuICAgICAgfnJlYWRfYnVmZmVyX3NpemVcbiAgICAgIHNvY2tldFxuZW5kXG5cbm1vZHVsZSBDbGllbnQgKElvIDogSU8pID0gc3RydWN0XG4gIG1vZHVsZSBHbHV0ZW4gPSBEcmVhbV9nbHV0ZW4uR2x1dGVuXG5cbiAgbW9kdWxlIENsaWVudF9jb25uZWN0aW9uID0gR2x1dGVuLkNsaWVudFxuXG4gIHR5cGUgc29ja2V0ID0gSW8uc29ja2V0XG5cbiAgdHlwZSB0ID1cbiAgICB7IGNvbm5lY3Rpb24gOiBDbGllbnRfY29ubmVjdGlvbi50XG4gICAgOyBzb2NrZXQgOiBzb2NrZXRcbiAgICB9XG5cbiAgbGV0IGNyZWF0ZSB+cmVhZF9idWZmZXJfc2l6ZSB+cHJvdG9jb2wgdCBzb2NrZXQgPVxuICAgIGxldCBjb25uZWN0aW9uID0gQ2xpZW50X2Nvbm5lY3Rpb24uY3JlYXRlIH5wcm90b2NvbCB0IGluXG4gICAgTHd0LmFzeW5jIChmdW4gKCkgLT5cbiAgICAgIElPX2xvb3Auc3RhcnRcbiAgICAgICAgKG1vZHVsZSBJbylcbiAgICAgICAgKG1vZHVsZSBDbGllbnRfY29ubmVjdGlvbilcbiAgICAgICAgY29ubmVjdGlvblxuICAgICAgICB+cmVhZF9idWZmZXJfc2l6ZVxuICAgICAgICBzb2NrZXQpO1xuICAgIEx3dC5yZXR1cm4geyBjb25uZWN0aW9uOyBzb2NrZXQgfVxuXG4gIGxldCB1cGdyYWRlIHQgcHJvdG9jb2wgPVxuICAgIENsaWVudF9jb25uZWN0aW9uLnVwZ3JhZGVfcHJvdG9jb2wgdC5jb25uZWN0aW9uIHByb3RvY29sXG5cbiAgbGV0IHNodXRkb3duIHQgPVxuICAgIENsaWVudF9jb25uZWN0aW9uLnNodXRkb3duIHQuY29ubmVjdGlvbjtcbiAgICBJby5jbG9zZSB0LnNvY2tldFxuXG4gIGxldCBpc19jbG9zZWQgdCA9IENsaWVudF9jb25uZWN0aW9uLmlzX2Nsb3NlZCB0LmNvbm5lY3Rpb25cbiAgbGV0IHNvY2tldCB0ID0gdC5zb2NrZXRcbmVuZFxuIl19
