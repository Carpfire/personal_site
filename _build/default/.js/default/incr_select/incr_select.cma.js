// Generated by js_of_ocaml
//# buildInfo:effects=false, kind=cma, use-js-string=true, version=5.6.0

//# unitInfo: Provides: Incr_select__
(function
  (globalThis){
   "use strict";
   var
    runtime = globalThis.jsoo_runtime,
    Incr_select = [0],
    Incr_select$0 = [0, Incr_select];
   runtime.caml_register_global(0, Incr_select$0, "Incr_select__");
   return;
  }
  (globalThis));

//# unitInfo: Provides: Incr_select__Incr_select_intf
//# unitInfo: Requires: Ppx_bench_lib__Benchmark_accumulator, Ppx_expect_runtime, Ppx_inline_test_lib, Ppx_module_timer_runtime
(function
  (globalThis){
   "use strict";
   var
    runtime = globalThis.jsoo_runtime,
    cst_Incr_select_Incr_select_in = "Incr_select__Incr_select_intf",
    cst_incr_select = "incr_select";
   function caml_call1(f, a0){
    return (f.l >= 0 ? f.l : f.l = f.length) == 1
            ? f(a0)
            : runtime.caml_call_gen(f, [a0]);
   }
   function caml_call2(f, a0, a1){
    return (f.l >= 0 ? f.l : f.l = f.length) == 2
            ? f(a0, a1)
            : runtime.caml_call_gen(f, [a0, a1]);
   }
   var
    global_data = runtime.caml_get_global_data(),
    Ppx_module_timer_runtime = global_data.Ppx_module_timer_runtime,
    Ppx_bench_lib_Benchmark_accumu =
      global_data.Ppx_bench_lib__Benchmark_accumulator,
    Ppx_expect_runtime = global_data.Ppx_expect_runtime,
    Ppx_inline_test_lib = global_data.Ppx_inline_test_lib;
   caml_call1(Ppx_module_timer_runtime[4], cst_Incr_select_Incr_select_in);
   caml_call1(Ppx_bench_lib_Benchmark_accumu[1][1], cst_incr_select);
   caml_call1(Ppx_expect_runtime[1][1], "src/incr_select_intf.ml");
   caml_call2(Ppx_inline_test_lib[6], cst_incr_select, "incr_select_intf.ml");
   caml_call1(Ppx_inline_test_lib[7], cst_incr_select);
   caml_call1(Ppx_expect_runtime[1][2], 0);
   caml_call1(Ppx_bench_lib_Benchmark_accumu[1][2], 0);
   caml_call1(Ppx_module_timer_runtime[5], cst_Incr_select_Incr_select_in);
   var Incr_select_Incr_select_intf = [0];
   runtime.caml_register_global
    (11, Incr_select_Incr_select_intf, cst_Incr_select_Incr_select_in);
   return;
  }
  (globalThis));

//# unitInfo: Provides: Incr_select
//# unitInfo: Requires: Core, Core__Fn, Core__Hash_set, Core__Hashtbl, Core__List, Core__Option, Ppx_bench_lib__Benchmark_accumulator, Ppx_expect_runtime, Ppx_inline_test_lib, Ppx_module_timer_runtime
(function
  (globalThis){
   "use strict";
   var
    runtime = globalThis.jsoo_runtime,
    cst_Incr_select = "Incr_select",
    cst_incr_select = "incr_select";
   function caml_call1(f, a0){
    return (f.l >= 0 ? f.l : f.l = f.length) == 1
            ? f(a0)
            : runtime.caml_call_gen(f, [a0]);
   }
   function caml_call2(f, a0, a1){
    return (f.l >= 0 ? f.l : f.l = f.length) == 2
            ? f(a0, a1)
            : runtime.caml_call_gen(f, [a0, a1]);
   }
   function caml_call3(f, a0, a1, a2){
    return (f.l >= 0 ? f.l : f.l = f.length) == 3
            ? f(a0, a1, a2)
            : runtime.caml_call_gen(f, [a0, a1, a2]);
   }
   function caml_call4(f, a0, a1, a2, a3){
    return (f.l >= 0 ? f.l : f.l = f.length) == 4
            ? f(a0, a1, a2, a3)
            : runtime.caml_call_gen(f, [a0, a1, a2, a3]);
   }
   var
    global_data = runtime.caml_get_global_data(),
    Core_Hash_set = global_data.Core__Hash_set,
    Core_List = global_data.Core__List,
    Core_Hashtbl = global_data.Core__Hashtbl,
    Core_Option = global_data.Core__Option,
    Core = global_data.Core,
    Core_Fn = global_data.Core__Fn,
    Ppx_module_timer_runtime = global_data.Ppx_module_timer_runtime,
    Ppx_bench_lib_Benchmark_accumu =
      global_data.Ppx_bench_lib__Benchmark_accumulator,
    Ppx_expect_runtime = global_data.Ppx_expect_runtime,
    Ppx_inline_test_lib = global_data.Ppx_inline_test_lib;
   caml_call1(Ppx_module_timer_runtime[4], cst_Incr_select);
   caml_call1(Ppx_bench_lib_Benchmark_accumu[1][1], cst_incr_select);
   caml_call1(Ppx_expect_runtime[1][1], "src/incr_select.ml");
   caml_call2(Ppx_inline_test_lib[6], cst_incr_select, "incr_select.ml");
   caml_call1(Ppx_inline_test_lib[7], cst_incr_select);
   caml_call1(Ppx_expect_runtime[1][2], 0);
   caml_call1(Ppx_bench_lib_Benchmark_accumu[1][2], 0);
   caml_call1(Ppx_module_timer_runtime[5], cst_Incr_select);
   var
    Incr_select =
      [0,
       function(Incr){
        var E = Incr[78], hashtbl_size = 10;
        function setup_generator(hashable, compute_output, make_input_node){
         var
          necessary_dependencies =
            caml_call4(Core_Hashtbl[87][1], 0, [0, hashtbl_size], hashable, 0);
         function make_key_stale(key){
          var
           _v_ = E[2][4],
           _w_ = caml_call2(Core_Hashtbl[56], necessary_dependencies, key),
           _x_ = caml_call2(Core_Option[39], _w_, 0);
          return caml_call2(Core_List[19], _x_, _v_);
         }
         var input_node = caml_call1(make_input_node, make_key_stale);
         caml_call2(Incr[58], input_node, Incr[57][6]);
         function _l_(key){
          var
           input_dep = caml_call2(E[1][2], 0, input_node),
           output_node = [];
          runtime.caml_update_dummy
           (output_node,
            [246,
             function(_m_){
              function _n_(param){return caml_call1(compute_output, key);}
              var
               _o_ =
                 [0,
                  function(is_now_observable){
                   if(is_now_observable){
                    var _p_ = caml_call1(Core[248], output_node);
                    return caml_call3
                            (Core_Hashtbl[81], necessary_dependencies, key, _p_);
                   }
                   function _q_(param){
                    if(! param) return 0;
                    var l = param[1], _r_ = caml_call1(Core[248], output_node);
                    function _s_(_u_){return _r_ === _u_ ? 1 : 0;}
                    var
                     _t_ = caml_call1(Core_Fn[2], _s_),
                     l$0 = caml_call2(Core_List[12], l, _t_);
                    return l$0 ? [0, l$0] : 0;
                   }
                   return caml_call3
                           (Core_Hashtbl[40], necessary_dependencies, key, _q_);
                  }];
              return caml_call2(E[2][2], _o_, _n_);
             }]);
          var output_node$0 = caml_call1(Core[248], output_node);
          caml_call2(E[2][6], output_node$0, input_dep);
          return caml_call1(E[2][3], output_node$0);
         }
         return caml_call1(Core[266], _l_);
        }
        function update_one(input, selected, make_stale){
         function _k_(inp){
          caml_call2(Core_Option[46], inp, make_stale);
          caml_call2(Core_Option[46], selected[1], make_stale);
          selected[1] = inp;
          return 0;
         }
         return caml_call2(Incr[9], input, _k_);
        }
        function select_one(H, input){
         var selected = [0, 0];
         function compute_output(key){
          var match = selected[1];
          if(! match) return 0;
          var key$0 = match[1], _j_ = caml_call2(H[1], key, key$0);
          return caml_call2(Core[90], _j_, 0);
         }
         function make_input_node(make_key_stale){
          return update_one(input, selected, make_key_stale);
         }
         return setup_generator(H[4], compute_output, make_input_node);
        }
        function select_one$0(h, input){
         return select_one(h, caml_call2(Incr[9], input, Core_Option[58]));
        }
        function select_one_value(H, default$0, input){
         var selected = [0, 0];
         function compute_output(key){
          var _h_ = selected[1];
          if(! _h_) return default$0;
          var
           match = _h_[1],
           data = match[2],
           key$0 = match[1],
           _i_ = caml_call2(H[1], key, key$0);
          return caml_call2(Core[90], _i_, 0) ? data : default$0;
         }
         function make_input_node(make_key_stale){
          return update_one
                  (input,
                   selected,
                   function(param){
                    var key = param[1];
                    return caml_call1(make_key_stale, key);
                   });
         }
         return setup_generator(H[4], compute_output, make_input_node);
        }
        function select_one_value$0(h, default$0, input){
         return select_one_value
                 (h, default$0, caml_call2(Incr[9], input, Core_Option[58]));
        }
        function select_many_values(H, default$0, input){
         var
          hashable = H[4],
          selected =
            caml_call4(Core_Hashtbl[87][1], 0, [0, hashtbl_size], hashable, 0);
         function compute_output(key){
          var _g_ = caml_call2(Core_Hashtbl[56], selected, key);
          return caml_call2(Core_Option[39], _g_, default$0);
         }
         function make_input_node(make_key_stale){
          function _e_(inp){
           caml_call2(Core_Hashtbl[19], selected, make_key_stale);
           caml_call1(Core_Hashtbl[16], selected);
           function _f_(param){
            var data = param[2], key = param[1];
            caml_call1(make_key_stale, key);
            return caml_call3(Core_Hashtbl[37], selected, key, data);
           }
           return caml_call2(Core_List[19], inp, _f_);
          }
          return caml_call2(Incr[9], input, _e_);
         }
         return setup_generator(hashable, compute_output, make_input_node);
        }
        function select_many(H, input){
         var
          hashable = H[4],
          selected =
            caml_call4
             (Core_Hash_set[38][1], 0, [0, hashtbl_size], hashable, 0);
         function compute_output(key){
          return caml_call2(Core_Hash_set[20], selected, key);
         }
         function make_input_node(make_key_stale){
          function _a_(inp){
           var old_set = caml_call1(Core_Hash_set[21], selected);
           caml_call1(Core_Hash_set[28], selected);
           function _b_(key){
            if(1 - caml_call2(Core_Hash_set[20], old_set, key))
             caml_call1(make_key_stale, key);
            return caml_call2(Core_Hash_set[22], selected, key);
           }
           caml_call2(Core_List[19], inp, _b_);
           function _c_(key){
            var _d_ = 1 - caml_call2(Core_Hash_set[20], selected, key);
            return _d_ ? caml_call1(make_key_stale, key) : _d_;
           }
           return caml_call2(Core_Hash_set[6], old_set, _c_);
          }
          return caml_call2(Incr[9], input, _a_);
         }
         return setup_generator(hashable, compute_output, make_input_node);
        }
        return [0,
                select_one$0,
                select_one,
                select_one_value$0,
                select_one_value,
                select_many,
                select_many_values];
       }];
   runtime.caml_register_global(17, Incr_select, cst_Incr_select);
   return;
  }
  (globalThis));

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLjAsImZpbGUiOiJpbmNyX3NlbGVjdC5jbWEuanMiLCJzb3VyY2VSb290IjoiIiwibmFtZXMiOlsiaGFzaHRibF9zaXplIiwic2V0dXBfZ2VuZXJhdG9yIiwiaGFzaGFibGUiLCJjb21wdXRlX291dHB1dCIsIm1ha2VfaW5wdXRfbm9kZSIsIm5lY2Vzc2FyeV9kZXBlbmRlbmNpZXMiLCJtYWtlX2tleV9zdGFsZSIsImtleSIsImlucHV0X25vZGUiLCJpbnB1dF9kZXAiLCJvdXRwdXRfbm9kZSIsImlzX25vd19vYnNlcnZhYmxlIiwibCIsImwkMCIsIm91dHB1dF9ub2RlJDAiLCJ1cGRhdGVfb25lIiwiaW5wdXQiLCJzZWxlY3RlZCIsIm1ha2Vfc3RhbGUiLCJpbnAiLCJzZWxlY3Rfb25lIiwiSCIsImtleSQwIiwic2VsZWN0X29uZSQwIiwiaCIsInNlbGVjdF9vbmVfdmFsdWUiLCJkZWZhdWx0JDAiLCJkYXRhIiwic2VsZWN0X29uZV92YWx1ZSQwIiwic2VsZWN0X21hbnlfdmFsdWVzIiwic2VsZWN0X21hbnkiLCJvbGRfc2V0Il0sInNvdXJjZXMiOlsiL2hvbWUvbGlhbS1jYXJwZW50ZXIvLm9wYW0vcGVyc29uYWwtc2l0ZS9saWIvaW5jcl9zZWxlY3QvaW5jcl9zZWxlY3RfXy5tbCIsIi9ob21lL2xpYW0tY2FycGVudGVyLy5vcGFtL3BlcnNvbmFsLXNpdGUvbGliL2luY3Jfc2VsZWN0L2luY3Jfc2VsZWN0Lm1sIl0sIm1hcHBpbmdzIjoiOzs7Ozs7O0dBS3VCOztJQUFBOzs7O0U7Ozs7Ozs7Ozs7OztHOzs7OztHOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7RTs7Ozs7Ozs7Ozs7O0c7Ozs7O0c7Ozs7O0c7Ozs7O0c7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OzswQkNFakJBO2lCQWNBQyxnQkFDREMsVUFDQ0MsZ0JBQ0FDO1NBSUE7VUFERUM7WUFDRix1Q0FyQkFMLGVBZURFO2tCQVNLSSxlQUFlQztVQUNqQjs7V0FBQSxNQUFBLDZCQUxBRix3QkFJaUJFO1dBQ2pCLE1B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QUlLQztZQUNtQixPQUFBLDhCQVB6Q1UsVUFNc0JWO1dBRUs7V0FGM0IsMEJBSHFCWTt3QkFNU1o7WUFDckIsY0FBQSw4QkFWVFUsVUFTOEJWO3lCQUNZLFdBUnpCRCxnQkFPYUM7V0FDOEI7V0FEbkMsT0FBQSw2QkFMckJ3QjtVQU15RDtVQVA3QyxPQUFBLG9CQUxnRGY7U0FZRjtTQUVsRSxPQW5JRWYsZ0JBc0hFQyxVQUVBQyxnQkFDQUM7UUFVcUQ7O2dCQTFEdkRtQjtnQkFqQkFIO2dCQXFDQVE7Z0JBbEJBSDtnQkEwQ0FLO2dCQXBCQUQ7Ozs7RSIsInNvdXJjZXNDb250ZW50IjpbIigqIGdlbmVyYXRlZCBieSBkdW5lICopXG5cbigqKiBAY2Fub25pY2FsIEluY3Jfc2VsZWN0LkluY3Jfc2VsZWN0X2ludGYgKilcbm1vZHVsZSBJbmNyX3NlbGVjdF9pbnRmID0gSW5jcl9zZWxlY3RfX0luY3Jfc2VsZWN0X2ludGZcblxubW9kdWxlIEluY3Jfc2VsZWN0X18gPSBzdHJ1Y3QgZW5kXG5bQEBkZXByZWNhdGVkIFwidGhpcyBtb2R1bGUgaXMgc2hhZG93ZWRcIl1cbiIsIm9wZW4gQ29yZVxuXG5tb2R1bGUgTWFrZSAoSW5jciA6IEluY3JlbWVudGFsLlNfZ2VuKSA9IHN0cnVjdFxuICBtb2R1bGUgRSA9IEluY3IuRXhwZXJ0XG5cbiAgKCogSGFzaHRibCBzdGFydHMgb3V0IGF0IGEgcmlkaWN1bG91cyBzaXplIG9mIDEyOC4gVGhpcyBpcyBhIG1vcmUgcmVhc29uYWJsZSBudW1iZXJcbiAgICAgb2YgYmlucyB0byBoYXZlLiAqKVxuICBsZXQgaGFzaHRibF9zaXplID0gMTBcblxuICAoKiogW3NldHVwX2dlbmVyYXRvcl0gc2V0cyB1cCB0aGUgc3RhZ2VkIGNvbnZlcnNpb24uXG5cbiAgICAgIFtoYXNoYWJsZV0gaXMgdXNlZCB0byBidWlsZCBhIHRhYmxlIG9mIG5lY2Vzc2FyeSBkZXBlbmRlbmNpZXMuIFdlIGRyb3AgdW5uZWNlc3NhcnlcbiAgICAgIGRlcGVuZGVuY2llcyB0byBhbGxvdyB0aGVtIHRvIGJlIGNvbGxlY3RlZC5cblxuICAgICAgW2NvbXB1dGVfb3V0cHV0IGtleV0gcmV0dXJucyB0aGUgdmFsdWUgb2YgdGhlIG91dHB1dCBub2RlIGNvcnJlc3BvbmRpbmcgdG8gW2tleV0uXG4gICAgICBbY29tcHV0ZV9vdXRwdXRdIGlzIGNsb3NlZCBvdmVyIHRoZSBtdXRhYmxlIHN0YXRlIGRldGVybWluaW5nIHRoZSBjdXJyZW50IHZhbHVlIG9mXG4gICAgICB0aGUgc2VsZWN0b3IncyBpbnB1dC5cblxuICAgICAgW21ha2VfaW5wdXRfbm9kZV0gbWFrZXMgc3VyZSB0aGF0IHdoZW4gdGhlIG11dGFibGUgc3RhdGUgaW5zaWRlIFtjb21wdXRlX291dHB1dF0gaXNcbiAgICAgIHVwZGF0ZWQsIHRoZSBjb3JyZXNwb25kaW5nIG5vZGVzIGluIHRoZSBbbmVjZXNzYXJ5X2RlcGVuZGVuY2llc10gdGFibGUgYXJlIG1hZGVcbiAgICAgIHN0YWxlLiAgKilcbiAgbGV0IHNldHVwX2dlbmVyYXRvclxuICAgIChoYXNoYWJsZSA6ICdhIEhhc2h0YmxfaW50Zi5IYXNoYWJsZS50KVxuICAgIH4oY29tcHV0ZV9vdXRwdXQgOiAnYSAtPiAnYilcbiAgICB+KG1ha2VfaW5wdXRfbm9kZSA6IG1ha2Vfa2V5X3N0YWxlOignYSAtPiB1bml0KSAtPiB1bml0IEluY3IudClcbiAgICA6ICgnYSAtPiAnYiBJbmNyLnQpIFN0YWdlZC50XG4gICAgPVxuICAgIGxldCBuZWNlc3NhcnlfZGVwZW5kZW5jaWVzID1cbiAgICAgIEhhc2h0YmwuVXNpbmdfaGFzaGFibGUuY3JlYXRlIH5zaXplOmhhc2h0Ymxfc2l6ZSB+aGFzaGFibGUgKClcbiAgICBpblxuICAgIGxldCAoaW5wdXRfbm9kZSA6IHVuaXQgSW5jci50KSA9XG4gICAgICBsZXQgbWFrZV9rZXlfc3RhbGUga2V5ID1cbiAgICAgICAgSGFzaHRibC5maW5kIG5lY2Vzc2FyeV9kZXBlbmRlbmNpZXMga2V5XG4gICAgICAgIHw+IE9wdGlvbi52YWx1ZSB+ZGVmYXVsdDpbXVxuICAgICAgICB8PiBMaXN0Lml0ZXIgfmY6RS5Ob2RlLm1ha2Vfc3RhbGVcbiAgICAgIGluXG4gICAgICBtYWtlX2lucHV0X25vZGUgfm1ha2Vfa2V5X3N0YWxlXG4gICAgaW5cbiAgICAoKiBTZXQgdGhlIGN1dG9mZiBzbyB0aGF0IHdlIG5ldmVyIHBhc3MgYXV0b21hdGljYWxseSBmcm9tIHRoZSB1cGRhdGUgdG8gdGhlIG5vZGVzLiBXZVxuICAgICAgIHdhbnQgZXZlcnl0aGluZyB0byBnbyB0aHJvdWdoIFttYWtlX2tleV9zdGFsZV0gKilcbiAgICBJbmNyLnNldF9jdXRvZmYgaW5wdXRfbm9kZSBJbmNyLkN1dG9mZi5hbHdheXM7XG4gICAgc3RhZ2UgKGZ1biBrZXkgLT5cbiAgICAgIGxldCBpbnB1dF9kZXAgPSBFLkRlcGVuZGVuY3kuY3JlYXRlIGlucHV0X25vZGUgaW5cbiAgICAgIGxldCByZWMgb3V0cHV0X25vZGUgPVxuICAgICAgICBsYXp5XG4gICAgICAgICAgKEUuTm9kZS5jcmVhdGVcbiAgICAgICAgICAgICAoZnVuICgpIC0+IGNvbXB1dGVfb3V0cHV0IGtleSlcbiAgICAgICAgICAgICB+b25fb2JzZXJ2YWJpbGl0eV9jaGFuZ2U6KGZ1biB+aXNfbm93X29ic2VydmFibGUgLT5cbiAgICAgICAgICAgICAgIGlmIGlzX25vd19vYnNlcnZhYmxlXG4gICAgICAgICAgICAgICB0aGVuXG4gICAgICAgICAgICAgICAgIEhhc2h0YmwuYWRkX211bHRpIG5lY2Vzc2FyeV9kZXBlbmRlbmNpZXMgfmtleSB+ZGF0YTooZm9yY2Ugb3V0cHV0X25vZGUpXG4gICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgIEhhc2h0YmwuY2hhbmdlIG5lY2Vzc2FyeV9kZXBlbmRlbmNpZXMga2V5IH5mOihmdW5jdGlvblxuICAgICAgICAgICAgICAgICAgIHwgTm9uZSAtPiBOb25lXG4gICAgICAgICAgICAgICAgICAgfCBTb21lIGwgLT5cbiAgICAgICAgICAgICAgICAgICAgIChtYXRjaFxuICAgICAgICAgICAgICAgICAgICAgICAgTGlzdC5maWx0ZXIgbCB+ZjooRm4ubm9uIChwaHlzX2VxdWFsIChmb3JjZSBvdXRwdXRfbm9kZSkpKVxuICAgICAgICAgICAgICAgICAgICAgIHdpdGhcbiAgICAgICAgICAgICAgICAgICAgICB8IFtdIC0+IE5vbmVcbiAgICAgICAgICAgICAgICAgICAgICB8IGwnIC0+IFNvbWUgbCcpKSkpXG4gICAgICBpblxuICAgICAgbGV0IG91dHB1dF9ub2RlID0gZm9yY2Ugb3V0cHV0X25vZGUgaW5cbiAgICAgIEUuTm9kZS5hZGRfZGVwZW5kZW5jeSBvdXRwdXRfbm9kZSBpbnB1dF9kZXA7XG4gICAgICBFLk5vZGUud2F0Y2ggb3V0cHV0X25vZGUpXG4gIDs7XG5cbiAgKCoqIFRoaXMgY3JlYXRlcyBhIHVuaXQgaW5jcmVtZW50YWwgdGhhdCBmaXJlcyB3aGVuZXZlciB0aGUgaW5wdXQgaW5jcmVtZW50YWxcbiAgICAgIGZpcmVzLiBXaGVuIHRoYXQgb2NjdXJzLCBpdCB1cGRhdGVzIFtzZWxlY3RlZF0gdG8gbWF0Y2ggdGhlIGN1cnJlbnQgdmFsdWUgb2ZcbiAgICAgIFtpbnB1dF0sIGFuZCBjYWxscyBbbWFrZV9rZXlfc3RhbGVdIGZvciBib3RoIHRoZSBvbGQgYW5kIG5ldyB2YWx1ZSBvZiB0aGVcbiAgICAgIGluY3JlbWVudGFsLiAqKVxuICBsZXQgdXBkYXRlX29uZSB+aW5wdXQgfnNlbGVjdGVkIH5tYWtlX3N0YWxlID1cbiAgICBJbmNyLm1hcCBpbnB1dCB+ZjooZnVuIGlucCAtPlxuICAgICAgT3B0aW9uLml0ZXIgaW5wIH5mOm1ha2Vfc3RhbGU7XG4gICAgICBPcHRpb24uaXRlciAhc2VsZWN0ZWQgfmY6bWFrZV9zdGFsZTtcbiAgICAgIHNlbGVjdGVkIDo9IGlucClcbiAgOztcblxuICBsZXQgc2VsZWN0X29uZSdcbiAgICAodHlwZSBhKVxuICAgIChtb2R1bGUgSCA6IEhhc2hhYmxlLkNvbW1vbiB3aXRoIHR5cGUgdCA9IGEpXG4gICAgKGlucHV0IDogYSBvcHRpb24gSW5jci50KVxuICAgID1cbiAgICBsZXQgc2VsZWN0ZWQgPSByZWYgTm9uZSBpblxuICAgIGxldCBjb21wdXRlX291dHB1dCBrZXkgPVxuICAgICAgbWF0Y2ggIXNlbGVjdGVkIHdpdGhcbiAgICAgIHwgTm9uZSAtPiBmYWxzZVxuICAgICAgfCBTb21lIGtleScgLT4gSC5jb21wYXJlIGtleSBrZXknID0gMFxuICAgIGluXG4gICAgbGV0IG1ha2VfaW5wdXRfbm9kZSB+bWFrZV9rZXlfc3RhbGUgPVxuICAgICAgdXBkYXRlX29uZSB+aW5wdXQgfnNlbGVjdGVkIH5tYWtlX3N0YWxlOm1ha2Vfa2V5X3N0YWxlXG4gICAgaW5cbiAgICBzZXR1cF9nZW5lcmF0b3IgSC5oYXNoYWJsZSB+Y29tcHV0ZV9vdXRwdXQgfm1ha2VfaW5wdXRfbm9kZVxuICA7O1xuXG4gIGxldCBzZWxlY3Rfb25lIGggaW5wdXQgPSBzZWxlY3Rfb25lJyBoIChJbmNyLm1hcCB+ZjpPcHRpb24uc29tZSBpbnB1dClcblxuICBsZXQgc2VsZWN0X29uZV92YWx1ZSdcbiAgICAodHlwZSBhKVxuICAgIChtb2R1bGUgSCA6IEhhc2hhYmxlLkNvbW1vbiB3aXRoIHR5cGUgdCA9IGEpXG4gICAgfmRlZmF1bHRcbiAgICBpbnB1dFxuICAgID1cbiAgICBsZXQgc2VsZWN0ZWQgPSByZWYgTm9uZSBpblxuICAgIGxldCBjb21wdXRlX291dHB1dCBrZXkgPVxuICAgICAgbWF0Y2ggIXNlbGVjdGVkIHdpdGhcbiAgICAgIHwgTm9uZSAtPiBkZWZhdWx0XG4gICAgICB8IFNvbWUgKGtleScsIGRhdGEpIC0+IGlmIEguY29tcGFyZSBrZXkga2V5JyA9IDAgdGhlbiBkYXRhIGVsc2UgZGVmYXVsdFxuICAgIGluXG4gICAgbGV0IG1ha2VfaW5wdXRfbm9kZSB+bWFrZV9rZXlfc3RhbGUgPVxuICAgICAgdXBkYXRlX29uZSB+c2VsZWN0ZWQgfmlucHV0IH5tYWtlX3N0YWxlOihmdW4gKGtleSwgXykgLT4gbWFrZV9rZXlfc3RhbGUga2V5KVxuICAgIGluXG4gICAgc2V0dXBfZ2VuZXJhdG9yIEguaGFzaGFibGUgfmNvbXB1dGVfb3V0cHV0IH5tYWtlX2lucHV0X25vZGVcbiAgOztcblxuICBsZXQgc2VsZWN0X29uZV92YWx1ZSBoIH5kZWZhdWx0IGlucHV0ID1cbiAgICBzZWxlY3Rfb25lX3ZhbHVlJyBoIH5kZWZhdWx0IChJbmNyLm1hcCB+ZjpPcHRpb24uc29tZSBpbnB1dClcbiAgOztcblxuICBsZXQgc2VsZWN0X21hbnlfdmFsdWVzXG4gICAgKHR5cGUgYSlcbiAgICAobW9kdWxlIEggOiBIYXNoYWJsZS5Db21tb24gd2l0aCB0eXBlIHQgPSBhKVxuICAgIH5kZWZhdWx0XG4gICAgaW5wdXRcbiAgICA9XG4gICAgbGV0IGhhc2hhYmxlID0gSC5oYXNoYWJsZSBpblxuICAgIGxldCBzZWxlY3RlZCA9IEhhc2h0YmwuVXNpbmdfaGFzaGFibGUuY3JlYXRlIH5zaXplOmhhc2h0Ymxfc2l6ZSB+aGFzaGFibGUgKCkgaW5cbiAgICBsZXQgY29tcHV0ZV9vdXRwdXQga2V5ID0gSGFzaHRibC5maW5kIHNlbGVjdGVkIGtleSB8PiBPcHRpb24udmFsdWUgfmRlZmF1bHQgaW5cbiAgICBsZXQgbWFrZV9pbnB1dF9ub2RlIH5tYWtlX2tleV9zdGFsZSA9XG4gICAgICBJbmNyLm1hcCBpbnB1dCB+ZjooZnVuIGlucCAtPlxuICAgICAgICBIYXNodGJsLml0ZXJfa2V5cyBzZWxlY3RlZCB+ZjptYWtlX2tleV9zdGFsZTtcbiAgICAgICAgSGFzaHRibC5jbGVhciBzZWxlY3RlZDtcbiAgICAgICAgTGlzdC5pdGVyIGlucCB+ZjooZnVuIChrZXksIGRhdGEpIC0+XG4gICAgICAgICAgbWFrZV9rZXlfc3RhbGUga2V5O1xuICAgICAgICAgIEhhc2h0Ymwuc2V0IHNlbGVjdGVkIH5rZXkgfmRhdGEpKVxuICAgIGluXG4gICAgc2V0dXBfZ2VuZXJhdG9yIGhhc2hhYmxlIH5jb21wdXRlX291dHB1dCB+bWFrZV9pbnB1dF9ub2RlXG4gIDs7XG5cbiAgbGV0IHNlbGVjdF9tYW55ICh0eXBlIGEpIChtb2R1bGUgSCA6IEhhc2hhYmxlLkNvbW1vbiB3aXRoIHR5cGUgdCA9IGEpIGlucHV0ID1cbiAgICBsZXQgaGFzaGFibGUgPSBILmhhc2hhYmxlIGluXG4gICAgbGV0IHNlbGVjdGVkID0gSGFzaF9zZXQuVXNpbmdfaGFzaGFibGUuY3JlYXRlIH5zaXplOmhhc2h0Ymxfc2l6ZSB+aGFzaGFibGUgKCkgaW5cbiAgICBsZXQgY29tcHV0ZV9vdXRwdXQga2V5ID0gSGFzaF9zZXQubWVtIHNlbGVjdGVkIGtleSBpblxuICAgIGxldCBtYWtlX2lucHV0X25vZGUgfm1ha2Vfa2V5X3N0YWxlID1cbiAgICAgIEluY3IubWFwIGlucHV0IH5mOihmdW4gaW5wIC0+XG4gICAgICAgIGxldCBvbGRfc2V0ID0gSGFzaF9zZXQuY29weSBzZWxlY3RlZCBpblxuICAgICAgICBIYXNoX3NldC5jbGVhciBzZWxlY3RlZDtcbiAgICAgICAgTGlzdC5pdGVyIGlucCB+ZjooZnVuIGtleSAtPlxuICAgICAgICAgIGlmIG5vdCAoSGFzaF9zZXQubWVtIG9sZF9zZXQga2V5KSB0aGVuIG1ha2Vfa2V5X3N0YWxlIGtleTtcbiAgICAgICAgICBIYXNoX3NldC5hZGQgc2VsZWN0ZWQga2V5KTtcbiAgICAgICAgSGFzaF9zZXQuaXRlciBvbGRfc2V0IH5mOihmdW4ga2V5IC0+XG4gICAgICAgICAgaWYgbm90IChIYXNoX3NldC5tZW0gc2VsZWN0ZWQga2V5KSB0aGVuIG1ha2Vfa2V5X3N0YWxlIGtleSkpXG4gICAgaW5cbiAgICBzZXR1cF9nZW5lcmF0b3IgaGFzaGFibGUgfmNvbXB1dGVfb3V0cHV0IH5tYWtlX2lucHV0X25vZGVcbiAgOztcbmVuZFxuIl19
