// Generated by js_of_ocaml
//# buildInfo:effects=false, kind=cma, use-js-string=true, version=5.6.0

//# unitInfo: Provides: Ui_time_source
//# unitInfo: Requires: Core, Core__List, Core__Time_ns, Ppx_bench_lib__Benchmark_accumulator, Ppx_expect_runtime, Ppx_inline_test_lib, Ppx_module_timer_runtime, Reversed_list, Sexplib0__Sexp_conv, Timing_wheel, Ui_effect, Ui_incr
(function
  (globalThis){
   "use strict";
   var
    runtime = globalThis.jsoo_runtime,
    cst_Ui_time_source$0 = "Ui_time_source",
    cst_ui_time_source$0 = "ui_time_source",
    cst_ui_time_source_ui_time_sou = "ui_time_source/ui_time_source.ml",
    caml_maybe_attach_backtrace = runtime.caml_maybe_attach_backtrace;
   function caml_call1(f, a0){
    return (f.l >= 0 ? f.l : f.l = f.length) == 1
            ? f(a0)
            : runtime.caml_call_gen(f, [a0]);
   }
   function caml_call2(f, a0, a1){
    return (f.l >= 0 ? f.l : f.l = f.length) == 2
            ? f(a0, a1)
            : runtime.caml_call_gen(f, [a0, a1]);
   }
   function caml_call3(f, a0, a1, a2){
    return (f.l >= 0 ? f.l : f.l = f.length) == 3
            ? f(a0, a1, a2)
            : runtime.caml_call_gen(f, [a0, a1, a2]);
   }
   var
    global_data = runtime.caml_get_global_data(),
    Reversed_list = global_data.Reversed_list,
    Ui_effect = global_data.Ui_effect,
    Core_List = global_data.Core__List,
    Timing_wheel = global_data.Timing_wheel,
    Ui_incr = global_data.Ui_incr,
    Core_Time_ns = global_data.Core__Time_ns,
    Assert_failure = global_data.Assert_failure,
    Sexplib0_Sexp_conv = global_data.Sexplib0__Sexp_conv,
    Core = global_data.Core,
    Ppx_module_timer_runtime = global_data.Ppx_module_timer_runtime,
    Ppx_bench_lib_Benchmark_accumu =
      global_data.Ppx_bench_lib__Benchmark_accumulator,
    Ppx_expect_runtime = global_data.Ppx_expect_runtime,
    Ppx_inline_test_lib = global_data.Ppx_inline_test_lib;
   caml_call1(Ppx_module_timer_runtime[4], cst_Ui_time_source$0);
   caml_call1(Ppx_bench_lib_Benchmark_accumu[1][1], cst_ui_time_source$0);
   caml_call1(Ppx_expect_runtime[1][1], cst_ui_time_source_ui_time_sou);
   caml_call2
    (Ppx_inline_test_lib[6], cst_ui_time_source$0, "ui_time_source.ml");
   var
    _c_ = [0, cst_ui_time_source_ui_time_sou, 66, 2],
    _a_ = [0, "incr_now"],
    _b_ = [0, "wheel_now"],
    cst_BUG_timing_wheel_and_incre =
      "BUG: timing wheel and incremental clock are out of sync",
    cst_ui_time_source = cst_ui_time_source$0,
    cst_Ui_time_source = cst_Ui_time_source$0;
   function invariant(t){
    var
     wheel_now = caml_call1(Timing_wheel[11], t[2]),
     incr_now = caml_call1(Ui_incr[80][6], t[1]),
     _r_ = 1 - caml_call2(Core_Time_ns[21], wheel_now, incr_now);
    if(! _r_) return _r_;
    var
     _s_ =
       [0,
        [1, [0, _a_, [0, caml_call1(Core_Time_ns[25][12], incr_now), 0]]],
        0],
     _t_ =
       [0,
        [1, [0, _b_, [0, caml_call1(Core_Time_ns[25][12], wheel_now), 0]]],
        _s_],
     _u_ =
       [1,
        [0,
         caml_call1(Sexplib0_Sexp_conv[7], cst_BUG_timing_wheel_and_incre),
         _t_]];
    return caml_call2(Core[257], 0, _u_);
   }
   function create(start){
    var
     _q_ = caml_call1(Core_Time_ns[93], start),
     start$0 = caml_call1(Core_Time_ns[95], _q_),
     config = Ui_incr[80][2],
     incr = caml_call3(Ui_incr[80][3], [0, config], start$0, 0),
     timing_wheel = caml_call2(Timing_wheel[9], config, start$0),
     t = [0, incr, timing_wheel, 0, 0, 0];
    invariant(t);
    return t;
   }
   function incr_clock(t){return t[1];}
   function now(t){
    var match = t[5];
    if(! match) return caml_call1(Timing_wheel[11], t[2]);
    var to = match[1];
    return to;
   }
   function at_intervals(t, span){
    return caml_call2(Ui_incr[80][12], t[1], span);
   }
   function watch_now(t){return caml_call1(Ui_incr[80][7], t[1]);}
   function at(t, at){return caml_call2(Ui_incr[80][10], t[1], at);}
   function advance_clock(t, to){
    var _p_ = now(t);
    if(! caml_call2(Core_Time_ns[15], to, _p_))
     throw caml_maybe_attach_backtrace([0, Assert_failure, _c_], 1);
    t[5] = [0, to];
    return 0;
   }
   function advance_clock_by(t, span){
    var _o_ = now(t);
    return advance_clock(t, caml_call2(Core_Time_ns[67], _o_, span));
   }
   function until(t, at){
    function _n_(callback){t[3] = [0, [0, at, callback], t[3]]; return 0;}
    return caml_call2(Ui_effect[22][2], 0, _n_);
   }
   function sleep(t, span){
    function _l_(callback){
     var _m_ = now(t), at = caml_call2(Core_Time_ns[67], _m_, span);
     t[3] = [0, [0, at, callback], t[3]];
     return 0;
    }
    return caml_call2(Ui_effect[22][2], 0, _l_);
   }
   function wait_after_display(t){
    function _k_(callback){t[4] = [0, callback, t[4]]; return 0;}
    return caml_call2(Ui_effect[22][2], 0, _k_);
   }
   function flush(t){
    function handle_fired(callback){
     var
      _i_ = caml_call2(Timing_wheel[5][5], t[2], callback),
      _j_ = caml_call2(Ui_effect[22][1][3], _i_, 0);
     return caml_call1(Ui_effect[21][2], _j_);
    }
    function _g_(param){
     var callback = param[2], at = param[1];
     caml_call3(Timing_wheel[26], t[2], at, callback);
     return 0;
    }
    var _h_ = caml_call1(Reversed_list[3], t[3]);
    caml_call2(Core_List[19], _h_, _g_);
    t[3] = 0;
    var match = t[5];
    if(match){
     var to = match[1];
     t[5] = 0;
     caml_call3(Timing_wheel[20], t[2], to, handle_fired);
     caml_call2(Timing_wheel[22], t[2], handle_fired);
     caml_call2(Ui_incr[80][8], t[1], to);
    }
    else
     caml_call2(Timing_wheel[22], t[2], handle_fired);
    return invariant(t);
   }
   function trigger_after_display(t){
    var callbacks = t[4];
    t[4] = 0;
    function _d_(callback){
     var _f_ = caml_call2(Ui_effect[22][1][3], callback, 0);
     return caml_call1(Ui_effect[21][2], _f_);
    }
    var _e_ = caml_call1(Reversed_list[3], callbacks);
    return caml_call2(Core_List[19], _e_, _d_);
   }
   function has_after_display_events(t){
    return 1 - caml_call1(Reversed_list[7], t[4]);
   }
   var Private = [0, flush, trigger_after_display, has_after_display_events];
   caml_call1(Ppx_inline_test_lib[7], cst_ui_time_source);
   caml_call1(Ppx_expect_runtime[1][2], 0);
   caml_call1(Ppx_bench_lib_Benchmark_accumu[1][2], 0);
   caml_call1(Ppx_module_timer_runtime[5], cst_Ui_time_source);
   var
    Ui_time_source =
      [0,
       create,
       incr_clock,
       advance_clock_by,
       advance_clock,
       now,
       watch_now,
       at_intervals,
       at,
       until,
       sleep,
       wait_after_display,
       Private];
   runtime.caml_register_global(24, Ui_time_source, cst_Ui_time_source$0);
   return;
  }
  (globalThis));

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLjAsImZpbGUiOiJ1aV90aW1lX3NvdXJjZS5jbWEuanMiLCJzb3VyY2VSb290IjoiIiwibmFtZXMiOlsiaW52YXJpYW50IiwidCIsIndoZWVsX25vdyIsImluY3Jfbm93IiwiY3JlYXRlIiwic3RhcnQiLCJzdGFydCQwIiwiY29uZmlnIiwiaW5jciIsInRpbWluZ193aGVlbCIsImluY3JfY2xvY2siLCJub3ciLCJ0byIsImF0X2ludGVydmFscyIsInNwYW4iLCJ3YXRjaF9ub3ciLCJhdCIsImFkdmFuY2VfY2xvY2siLCJhZHZhbmNlX2Nsb2NrX2J5IiwidW50aWwiLCJjYWxsYmFjayIsInNsZWVwIiwid2FpdF9hZnRlcl9kaXNwbGF5IiwiZmx1c2giLCJoYW5kbGVfZmlyZWQiLCJ0cmlnZ2VyX2FmdGVyX2Rpc3BsYXkiLCJjYWxsYmFja3MiLCJoYXNfYWZ0ZXJfZGlzcGxheV9ldmVudHMiXSwic291cmNlcyI6WyIvaG9tZS9saWFtLWNhcnBlbnRlci8ub3BhbS9wZXJzb25hbC1zaXRlL2xpYi9pbmNyX2RvbS91aV90aW1lX3NvdXJjZS91aV90aW1lX3NvdXJjZS5tbCJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Rzs7Ozs7Rzs7Ozs7Rzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztZQWdCSUEsVUFBVUM7SUFJWjtLQUFJQyxZQUFZLDZCQUpKRDtLQUtSRSxXQUFXLDJCQUxIRjtLQU1MLFVBQUEsNkJBRkhDLFdBQ0FDO2NBQ0c7Ozs7MERBREhBOzs7OzBEQURBRDs7Ozs7Ozs7R0FRMEM7WUFHNUNFLE9BQVFDO0lBQ1Y7S0FHSSxNQUFBLDZCQUpNQTtLQUNOQyxVQUVGO0tBR0VDO0tBQ0FDLE9BQU8sK0JBRFBELFNBTEFEO0tBT0FHLGVBQWUsNEJBRmZGLFFBTEFEO0tBUUFMLFFBRkFPLE1BQ0FDO0lBdkJGVCxVQXdCRUM7SUFRSixPQVJJQTtHQVNIO1lBR0NTLFdBQVdULEdBQUksT0FBSkEsS0FBVTtZQUVyQlUsSUFBSVY7SUFDTixZQURNQTtvREFBQUE7UUFFQ1c7SUFBTyxPQUFQQTtHQUNrQztZQUd2Q0MsYUFBYVosR0FBRWE7SUFBTyxPQUFBLDRCQUFUYixNQUFFYTtHQUEwQztZQUN6REMsVUFBVWQsR0FBSSxrQ0FBSkEsTUFBK0I7WUFDekNlLEdBQUdmLEdBQUVlLElBQUssT0FBQSw0QkFBUGYsTUFBRWUsSUFBNEI7WUFFakNDLGNBQWNoQixHQUFHVztJQUNRLFVBWHpCRCxJQVVjVjtJQUNULEtBQUEsNkJBRFlXO0tBQ25CLE1BQUE7SUFEZ0JYLFdBQUdXOztHQUVLO1lBR3RCTSxpQkFBaUJqQixHQUFFYTtJQUF5QyxVQWY1REgsSUFlaUJWO0lBQThCLE9BTC9DZ0IsY0FLaUJoQixHQUE4QixrQ0FBNUJhO0dBQXNEO1lBU3pFSyxNQUFNbEIsR0FBRWU7aUJBQ3NDSSxVQUR4Q25CLGVBQUVlLElBQ3NDSSxXQUR4Q25CLGdCQUV3RDtJQURyQixPQUFBO0dBQ3NCO1lBRy9Eb0IsTUFBTXBCLEdBQUVhO2lCQUNzQ007S0FDOUMsSUFBcUIsTUEvQnJCVCxJQTZCTVYsSUFFRmUsS0FBSyxrQ0FGREY7S0FBRmIsZUFFRmUsSUFEMENJLFdBRHhDbkI7O0lBR3dEO0lBRnJCLE9BQUE7R0FFc0I7WUFHL0RxQixtQkFBbUJyQjtpQkFDMkJtQixVQUQzQm5CLFdBQzJCbUIsVUFEM0JuQixnQkFFeUQ7SUFEbkMsT0FBQTtHQUNvQztZQUkzRXNCLE1BQU10QjthQUNKdUIsYUFBYUo7S0FDZjtNQUVLLE1BQUEsK0JBSkNuQixNQUNTbUI7TUFFYixNQUFBO0tBQUEsT0FBQTtJQUVNO0lBRVY7S0FBc0QsSUFBVUEscUJBQUpKO0tBQ3ZCLDZCQVI3QmYsTUFPb0RlLElBQUlJO0tBQzNCO0lBQ2hDO0lBRkssVUFBQSw2QkFQRm5CO0lBT1I7SUFQUUE7Z0JBQUFBOztTQVlBVztLQVpBWDtLQWNMLDZCQWRLQSxNQVlBVyxJQVhKWTtLQWNELDZCQWZLdkIsTUFDSnVCO0tBZUQsMkJBaEJLdkIsTUFZQVc7OztLQUtHLDZCQWpCSFgsTUFDSnVCO0lBaUJKLE9BakdBeEIsVUErRVFDO0dBa0JHO1lBR1R3QixzQkFBc0J4QjtJQUN4QixJQUFJeUIsWUFEb0J6QjtJQUFBQTtJQUd4QixhQUFnRG1CO0tBQ3pCLFVBQUEsZ0NBRHlCQTtLQUN6QixPQUFBO0lBQWdEO0lBRDdELFVBQUEsNkJBRk5NO0lBRXVDLE9BQUE7R0FDNkI7WUFHdEVDLHlCQUF5QjFCO0lBQzNCLFdBQUksNkJBRHVCQTtHQUNnQztHQTlCOUMsa0JBQ1hzQixPQXFCQUUsdUJBT0FFOzs7Ozs7OztPQTVGRnZCO09BcUJBTTtPQWlCQVE7T0FMQUQ7T0FWQU47T0FPQUk7T0FEQUY7T0FFQUc7T0FnQkFHO09BS0FFO09BTUFDOzs7O0UiLCJzb3VyY2VzQ29udGVudCI6WyJvcGVuISBDb3JlXG5tb2R1bGUgSW5jciA9IFVpX2luY3Jcbm1vZHVsZSBFZmZlY3QgPSBVaV9lZmZlY3RcblxudHlwZSB0ID1cbiAgeyBpbmNyIDogSW5jci5DbG9jay50XG4gIDsgdGltaW5nX3doZWVsIDogKHVuaXQsIHVuaXQpIFVpX2VmZmVjdC5Qcml2YXRlLkNhbGxiYWNrLnQgVGltaW5nX3doZWVsLnRcbiAgOyBtdXRhYmxlXG4gICAgICBhZGRfYmVmb3JlX2FkdmFuY2UgOlxuICAgICAgKFRpbWVfbnMudCAqICh1bml0LCB1bml0KSBVaV9lZmZlY3QuUHJpdmF0ZS5DYWxsYmFjay50KSBSZXZlcnNlZF9saXN0LnRcbiAgOyBtdXRhYmxlXG4gICAgICB3YWl0X2FmdGVyX2Rpc3BsYXlfY2FsbGJhY2tzIDpcbiAgICAgICh1bml0LCB1bml0KSBVaV9lZmZlY3QuUHJpdmF0ZS5DYWxsYmFjay50IFJldmVyc2VkX2xpc3QudFxuICA7IG11dGFibGUgYWR2YW5jZV90byA6IFRpbWVfbnMudCBvcHRpb25cbiAgfVxuXG5sZXQgaW52YXJpYW50IHQgPVxuICAoKiBUaGlzIGlzIG9ubHkgYSBzb2Z0IGludmFyaWFudCAoaXQgcHJpbnRzIGluc3RlYWQgb2YgcmFpc2luZykgYmVjYXVzZSBpdFxuICAgICBwcm9iYWJseSBpc24ndCBmYXRhbCBpZiB0aGUgdHdvIGNsb2NrcyBhcmUgb3V0IG9mIHN5bmMuIFdlIHdhbnQgdG8ga25vd1xuICAgICBhYm91dCBpdCBpZiB0aGV5IGFyZSwgdGhvdWdoLiAqKVxuICBsZXQgd2hlZWxfbm93ID0gVGltaW5nX3doZWVsLm5vdyB0LnRpbWluZ193aGVlbCBpblxuICBsZXQgaW5jcl9ub3cgPSBJbmNyLkNsb2NrLm5vdyB0LmluY3IgaW5cbiAgaWYgbm90IChUaW1lX25zLmVxdWFsIHdoZWVsX25vdyBpbmNyX25vdylcbiAgdGhlblxuICAgIGVwcmludF9zXG4gICAgICBbJW1lc3NhZ2VcbiAgICAgICAgXCJCVUc6IHRpbWluZyB3aGVlbCBhbmQgaW5jcmVtZW50YWwgY2xvY2sgYXJlIG91dCBvZiBzeW5jXCJcbiAgICAgICAgICAod2hlZWxfbm93IDogVGltZV9ucy5BbHRlcm5hdGVfc2V4cC50KVxuICAgICAgICAgIChpbmNyX25vdyA6IFRpbWVfbnMuQWx0ZXJuYXRlX3NleHAudCldXG47O1xuXG5sZXQgY3JlYXRlIH5zdGFydCA9XG4gIGxldCBzdGFydCA9XG4gICAgKCogV2Ugcm91bmQgdGhlIHN0YXJ0IHRpbWUgdG8gbWF0Y2ggd2hhdCBbSW5jci5DbG9jay5jcmVhdGVdIGRvZXMuICopXG4gICAgVGltZV9ucy5vZl90aW1lX2Zsb2F0X3JvdW5kX25lYXJlc3RfbWljcm9zZWNvbmRcbiAgICAgIChUaW1lX25zLnRvX3RpbWVfZmxvYXRfcm91bmRfbmVhcmVzdF9taWNyb3NlY29uZCBzdGFydClcbiAgaW5cbiAgbGV0IGNvbmZpZyA9IEluY3IuQ2xvY2suZGVmYXVsdF90aW1pbmdfd2hlZWxfY29uZmlnIGluXG4gIGxldCBpbmNyID0gSW5jci5DbG9jay5jcmVhdGUgfnRpbWluZ193aGVlbF9jb25maWc6Y29uZmlnIH5zdGFydCAoKSBpblxuICBsZXQgdGltaW5nX3doZWVsID0gVGltaW5nX3doZWVsLmNyZWF0ZSB+Y29uZmlnIH5zdGFydCBpblxuICBsZXQgdCA9XG4gICAgeyBpbmNyXG4gICAgOyB0aW1pbmdfd2hlZWxcbiAgICA7IGFkZF9iZWZvcmVfYWR2YW5jZSA9IFtdXG4gICAgOyB3YWl0X2FmdGVyX2Rpc3BsYXlfY2FsbGJhY2tzID0gW11cbiAgICA7IGFkdmFuY2VfdG8gPSBOb25lXG4gICAgfVxuICBpblxuICBpbnZhcmlhbnQgdDtcbiAgdFxuOztcblxubGV0IGluY3JfY2xvY2sgdCA9IHQuaW5jclxuXG5sZXQgbm93IHQgPVxuICBtYXRjaCB0LmFkdmFuY2VfdG8gd2l0aFxuICB8IFNvbWUgdG9fIC0+IHRvX1xuICB8IE5vbmUgLT4gVGltaW5nX3doZWVsLm5vdyB0LnRpbWluZ193aGVlbFxuOztcblxubGV0IGF0X2ludGVydmFscyB0IHNwYW4gPSBJbmNyLkNsb2NrLmF0X2ludGVydmFscyB0LmluY3Igc3BhblxubGV0IHdhdGNoX25vdyB0ID0gSW5jci5DbG9jay53YXRjaF9ub3cgdC5pbmNyXG5sZXQgYXQgdCBhdCA9IEluY3IuQ2xvY2suYXQgdC5pbmNyIGF0XG5cbmxldCBhZHZhbmNlX2Nsb2NrIHQgfnRvXyA9XG4gIGFzc2VydCAoVGltZV9ucy4oID49ICkgdG9fIChub3cgdCkpO1xuICB0LmFkdmFuY2VfdG8gPC0gU29tZSB0b19cbjs7XG5cbmxldCBhZHZhbmNlX2Nsb2NrX2J5IHQgc3BhbiA9IGFkdmFuY2VfY2xvY2sgdCB+dG9fOihUaW1lX25zLmFkZCAobm93IHQpIHNwYW4pXG5cbigqIFt1bnRpbF0sIFtzbGVlcF0sIGFuZCBbd2FpdF9hZnRlcl9kaXNwbGF5XSBhbGwgd2FudCB0byBhZGQgYWxhcm1zIHRvIFt0LnRpbWluZ193aGVlbF0sXG4gICB3aGljaCB0aHJvd3MgaWYgd2UncmUgYWxyZWFkeSBpbiB0aGUgbWlkZGxlIG9mIGFuIGFsYXJtLiBJbnN0ZWFkIG9mIGFkZGluZyBpdCB0byB0aGVcbiAgIHRpbWluZyB3aGVlbCBpbW1lZGlhdGVseSwgd2Ugc3RvcmUgaXQgYW5kIHRoZW4gYWRkIGl0IG5leHQgdGltZSB0aGUgdGltaW5nIHdoZWVsIGlzXG4gICBhZHZhbmNlZC5cblxuICAgTm90ZTogdGhlIGFsYXJtcyBhcmUgYWRkZWQgYXMgcGFydCBvZiBbZmx1c2hdLCB3aGljaCBpcyB0aGUgb25seSBwbGFjZSB0aGF0IHdlIGFjdHVhbGx5XG4gICBhZHZhbmNlIFt0LnRpbWVfc291cmNlXSwgd2hpY2ggbWFrZXMgdGhpcyBhcHByb2FjaCBzb3VuZC4gKilcbmxldCB1bnRpbCB0IGF0ID1cbiAgRWZmZWN0LlByaXZhdGUubWFrZSB+cmVxdWVzdDooKSB+ZXZhbHVhdG9yOihmdW4gY2FsbGJhY2sgLT5cbiAgICB0LmFkZF9iZWZvcmVfYWR2YW5jZSA8LSAoYXQsIGNhbGxiYWNrKSA6OiB0LmFkZF9iZWZvcmVfYWR2YW5jZSlcbjs7XG5cbmxldCBzbGVlcCB0IHNwYW4gPVxuICBFZmZlY3QuUHJpdmF0ZS5tYWtlIH5yZXF1ZXN0OigpIH5ldmFsdWF0b3I6KGZ1biBjYWxsYmFjayAtPlxuICAgIGxldCBhdCA9IFRpbWVfbnMuYWRkIChub3cgdCkgc3BhbiBpblxuICAgIHQuYWRkX2JlZm9yZV9hZHZhbmNlIDwtIChhdCwgY2FsbGJhY2spIDo6IHQuYWRkX2JlZm9yZV9hZHZhbmNlKVxuOztcblxubGV0IHdhaXRfYWZ0ZXJfZGlzcGxheSB0ID1cbiAgRWZmZWN0LlByaXZhdGUubWFrZSB+cmVxdWVzdDooKSB+ZXZhbHVhdG9yOihmdW4gY2FsbGJhY2sgLT5cbiAgICB0LndhaXRfYWZ0ZXJfZGlzcGxheV9jYWxsYmFja3MgPC0gY2FsbGJhY2sgOjogdC53YWl0X2FmdGVyX2Rpc3BsYXlfY2FsbGJhY2tzKVxuOztcblxubW9kdWxlIFByaXZhdGUgPSBzdHJ1Y3RcbiAgbGV0IGZsdXNoIHQgPVxuICAgIGxldCBoYW5kbGVfZmlyZWQgY2FsbGJhY2sgPVxuICAgICAgRWZmZWN0LkV4cGVydC5oYW5kbGVcbiAgICAgICAgKEVmZmVjdC5Qcml2YXRlLkNhbGxiYWNrLnJlc3BvbmRfdG9cbiAgICAgICAgICAgKFRpbWluZ193aGVlbC5BbGFybS52YWx1ZSB0LnRpbWluZ193aGVlbCBjYWxsYmFjaylcbiAgICAgICAgICAgKCkpXG4gICAgaW5cbiAgICBMaXN0Lml0ZXIgKFJldmVyc2VkX2xpc3QucmV2IHQuYWRkX2JlZm9yZV9hZHZhbmNlKSB+ZjooZnVuIChhdCwgY2FsbGJhY2spIC0+XG4gICAgICBsZXQgKF8gOiBfIFRpbWluZ193aGVlbC5BbGFybS50KSA9IFRpbWluZ193aGVlbC5hZGQgdC50aW1pbmdfd2hlZWwgfmF0IGNhbGxiYWNrIGluXG4gICAgICAoKSk7XG4gICAgdC5hZGRfYmVmb3JlX2FkdmFuY2UgPC0gW107XG4gICAgKG1hdGNoIHQuYWR2YW5jZV90byB3aXRoXG4gICAgIHwgU29tZSB0b18gLT5cbiAgICAgICB0LmFkdmFuY2VfdG8gPC0gTm9uZTtcbiAgICAgICBUaW1pbmdfd2hlZWwuYWR2YW5jZV9jbG9jayB0LnRpbWluZ193aGVlbCB+dG9fIH5oYW5kbGVfZmlyZWQ7XG4gICAgICAgVGltaW5nX3doZWVsLmZpcmVfcGFzdF9hbGFybXMgdC50aW1pbmdfd2hlZWwgfmhhbmRsZV9maXJlZDtcbiAgICAgICBJbmNyLkNsb2NrLmFkdmFuY2VfY2xvY2sgdC5pbmNyIH50b19cbiAgICAgfCBOb25lIC0+IFRpbWluZ193aGVlbC5maXJlX3Bhc3RfYWxhcm1zIHQudGltaW5nX3doZWVsIH5oYW5kbGVfZmlyZWQpO1xuICAgIGludmFyaWFudCB0XG4gIDs7XG5cbiAgbGV0IHRyaWdnZXJfYWZ0ZXJfZGlzcGxheSB0ID1cbiAgICBsZXQgY2FsbGJhY2tzID0gdC53YWl0X2FmdGVyX2Rpc3BsYXlfY2FsbGJhY2tzIGluXG4gICAgdC53YWl0X2FmdGVyX2Rpc3BsYXlfY2FsbGJhY2tzIDwtIFtdO1xuICAgIExpc3QuaXRlciAoUmV2ZXJzZWRfbGlzdC5yZXYgY2FsbGJhY2tzKSB+ZjooZnVuIGNhbGxiYWNrIC0+XG4gICAgICBFZmZlY3QuRXhwZXJ0LmhhbmRsZSAoRWZmZWN0LlByaXZhdGUuQ2FsbGJhY2sucmVzcG9uZF90byBjYWxsYmFjayAoKSkpXG4gIDs7XG5cbiAgbGV0IGhhc19hZnRlcl9kaXNwbGF5X2V2ZW50cyB0ID1cbiAgICBub3QgKFJldmVyc2VkX2xpc3QuaXNfZW1wdHkgdC53YWl0X2FmdGVyX2Rpc3BsYXlfY2FsbGJhY2tzKVxuICA7O1xuZW5kXG4iXX0=
